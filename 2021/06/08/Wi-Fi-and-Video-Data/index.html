<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    
<meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width,user-scalable=no,initial-scale=1,minimum-scale=1,maximum-scale=1">


<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />



  <meta name="description" content="A Wi-Fi and Video Data-Based Study on Spatial-Temporal Characteristics of Rural Space Behavior"/>




  <meta name="keywords" content="城市研究,建筑学,论文," />





  <link rel="alternate" href="/atom.xml" title="Yefan Zhi Stockpile" type="application/atom+xml">




  <link rel="shortcut icon" type="image/x-icon" href="/List%20Drop.png?v=1.1" />



<link rel="canonical" href="https://Jiaomubaobao233.github.io/2021/06/08/Wi-Fi-and-Video-Data/"/>


<meta name="description" content="A Wi-Fi and Video Data-Based Study on Spatial-Temporal Characteristics of Rural Space Behavior">
<meta property="og:type" content="article">
<meta property="og:title" content="基于Wi-Fi和视频数据的农村空间行为时空特征研究">
<meta property="og:url" content="https://jiaomubaobao233.github.io/2021/06/08/Wi-Fi-and-Video-Data/index.html">
<meta property="og:site_name" content="Yefan Zhi Stockpile">
<meta property="og:description" content="A Wi-Fi and Video Data-Based Study on Spatial-Temporal Characteristics of Rural Space Behavior">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://jiaomubaobao233.github.io/2021/06/08/Wi-Fi-and-Video-Data/image002.jpg">
<meta property="og:image" content="https://jiaomubaobao233.github.io/2021/06/08/Wi-Fi-and-Video-Data/image003.jpg">
<meta property="og:image" content="https://jiaomubaobao233.github.io/2021/06/08/Wi-Fi-and-Video-Data/image004.jpg">
<meta property="og:image" content="https://jiaomubaobao233.github.io/2021/06/08/Wi-Fi-and-Video-Data/image005.jpg">
<meta property="og:image" content="https://jiaomubaobao233.github.io/2021/06/08/Wi-Fi-and-Video-Data/image006.png">
<meta property="og:image" content="https://jiaomubaobao233.github.io/2021/06/08/Wi-Fi-and-Video-Data/image007.jpg">
<meta property="og:image" content="https://jiaomubaobao233.github.io/2021/06/08/Wi-Fi-and-Video-Data/image008.jpg">
<meta property="og:image" content="https://jiaomubaobao233.github.io/2021/06/08/Wi-Fi-and-Video-Data/image009.png">
<meta property="og:image" content="https://jiaomubaobao233.github.io/2021/06/08/Wi-Fi-and-Video-Data/image010.jpg">
<meta property="og:image" content="https://jiaomubaobao233.github.io/2021/06/08/Wi-Fi-and-Video-Data/image011.jpg">
<meta property="og:image" content="https://jiaomubaobao233.github.io/2021/06/08/Wi-Fi-and-Video-Data/image012.jpg">
<meta property="og:image" content="https://jiaomubaobao233.github.io/2021/06/08/Wi-Fi-and-Video-Data/image013.jpg">
<meta property="og:image" content="https://jiaomubaobao233.github.io/2021/06/08/Wi-Fi-and-Video-Data/image014.jpg">
<meta property="og:image" content="https://jiaomubaobao233.github.io/2021/06/08/Wi-Fi-and-Video-Data/image015.jpg">
<meta property="og:image" content="https://jiaomubaobao233.github.io/2021/06/08/Wi-Fi-and-Video-Data/image017.jpg">
<meta property="og:image" content="https://jiaomubaobao233.github.io/2021/06/08/Wi-Fi-and-Video-Data/image018.jpg">
<meta property="og:image" content="https://jiaomubaobao233.github.io/2021/06/08/Wi-Fi-and-Video-Data/image019.jpg">
<meta property="og:image" content="https://jiaomubaobao233.github.io/2021/06/08/Wi-Fi-and-Video-Data/image020.jpg">
<meta property="og:image" content="https://jiaomubaobao233.github.io/2021/06/08/Wi-Fi-and-Video-Data/image021.jpg">
<meta property="og:image" content="https://jiaomubaobao233.github.io/2021/06/08/Wi-Fi-and-Video-Data/image022.jpg">
<meta property="og:image" content="https://jiaomubaobao233.github.io/2021/06/08/Wi-Fi-and-Video-Data/image023.jpg">
<meta property="og:image" content="https://jiaomubaobao233.github.io/2021/06/08/Wi-Fi-and-Video-Data/image024.jpg">
<meta property="og:image" content="https://jiaomubaobao233.github.io/2021/06/08/Wi-Fi-and-Video-Data/image025.jpg">
<meta property="og:image" content="https://jiaomubaobao233.github.io/2021/06/08/Wi-Fi-and-Video-Data/image026.jpg">
<meta property="og:image" content="https://jiaomubaobao233.github.io/2021/06/08/Wi-Fi-and-Video-Data/image027.jpg">
<meta property="og:image" content="https://jiaomubaobao233.github.io/2021/06/08/Wi-Fi-and-Video-Data/image028.jpg">
<meta property="og:image" content="https://jiaomubaobao233.github.io/2021/06/08/Wi-Fi-and-Video-Data/image029.jpg">
<meta property="og:image" content="https://jiaomubaobao233.github.io/2021/06/08/Wi-Fi-and-Video-Data/image030.jpg">
<meta property="og:image" content="https://jiaomubaobao233.github.io/2021/06/08/Wi-Fi-and-Video-Data/image031.jpg">
<meta property="og:image" content="https://jiaomubaobao233.github.io/2021/06/08/Wi-Fi-and-Video-Data/image032.jpg">
<meta property="og:image" content="https://jiaomubaobao233.github.io/2021/06/08/Wi-Fi-and-Video-Data/image033.jpg">
<meta property="og:image" content="https://jiaomubaobao233.github.io/2021/06/08/Wi-Fi-and-Video-Data/image034.jpg">
<meta property="og:image" content="https://jiaomubaobao233.github.io/2021/06/08/Wi-Fi-and-Video-Data/image035.jpg">
<meta property="og:image" content="https://jiaomubaobao233.github.io/2021/06/08/Wi-Fi-and-Video-Data/image036.jpg">
<meta property="og:image" content="https://jiaomubaobao233.github.io/2021/06/08/Wi-Fi-and-Video-Data/image037.jpg">
<meta property="og:image" content="https://jiaomubaobao233.github.io/2021/06/08/Wi-Fi-and-Video-Data/image038.jpg">
<meta property="og:image" content="https://jiaomubaobao233.github.io/2021/06/08/Wi-Fi-and-Video-Data/image039.jpg">
<meta property="og:image" content="https://jiaomubaobao233.github.io/2021/06/08/Wi-Fi-and-Video-Data/image040.jpg">
<meta property="og:image" content="https://jiaomubaobao233.github.io/2021/06/08/Wi-Fi-and-Video-Data/image041.jpg">
<meta property="og:image" content="https://jiaomubaobao233.github.io/2021/06/08/Wi-Fi-and-Video-Data/image042.jpg">
<meta property="og:image" content="https://jiaomubaobao233.github.io/2021/06/08/Wi-Fi-and-Video-Data/image043.jpg">
<meta property="og:image" content="https://jiaomubaobao233.github.io/2021/06/08/Wi-Fi-and-Video-Data/image044.jpg">
<meta property="og:image" content="https://jiaomubaobao233.github.io/2021/06/08/Wi-Fi-and-Video-Data/image045.jpg">
<meta property="article:published_time" content="2021-06-08T08:23:16.000Z">
<meta property="article:modified_time" content="2022-04-03T18:20:11.105Z">
<meta property="article:author" content="Yefan Zhi">
<meta property="article:tag" content="城市研究">
<meta property="article:tag" content="建筑学">
<meta property="article:tag" content="论文">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://jiaomubaobao233.github.io/2021/06/08/Wi-Fi-and-Video-Data/image002.jpg">


<link rel="stylesheet" type="text/css" href="/css/style.css?v=1.1" />
<link href='https://fonts.googleapis.com/css?family=Open+Sans' rel='stylesheet'>





<script type="text/javascript">
  var themeConfig = {
    fancybox: {
      enable: false
    },
  };
</script>




  



    <title> 基于Wi-Fi和视频数据的农村空间行为时空特征研究 - Yefan Zhi Stockpile </title>
  <meta name="generator" content="Hexo 5.2.0"></head>

  <body>
    <div id="page">
      <header id="masthead"><div class="site-header-inner">
    <h1 class="site-title">
        <a href="/." class="logo">Yefan Zhi Stockpile</a>
    </h1>

    <nav id="nav-top">
        
            <ul id="menu-top" class="nav-top-items">
                
                    <li class="menu-item">
                        <a href="/archives">
                            
                            
                                Archives
                            
                        </a>
                    </li>
                
                    <li class="menu-item">
                        <a href="/about">
                            
                            
                                About
                            
                        </a>
                    </li>
                
            </ul>
        
  </nav>
</div>

      </header>
      <div id="content">
        
    <div id="primary">
        
  <article class="post">
    <header class="post-header">
      <h1 class="post-title">
        
          基于Wi-Fi和视频数据的农村空间行为时空特征研究
        
      </h1>

      <time class="post-time">
          6月 08 2021
          
      </time>
      
    </header>



    
           <div class="post-excerpt post-content">
            
            
              
            

            
              A Wi-Fi and Video Data-Based Study on Spatial-Temporal Characteristics of Rural Space Behavior
        </div>
            
            <div class="post-content">
            <h2 id="摘要"><a href="#摘要" class="headerlink" title="摘要"></a>摘要</h2><p>农村人居环境改善是现代治理的重要组成部分。农村空间行为则是其效益的重要表征。在环境行为学技术更新的背景下，本文基于Wi-Fi和视频数据对天津市蓟州区蒋家胡同村和小穿芳峪村的空间行为时空特征展开探究。</p>
<p>通过Wi-Fi定位技术和数据的处理分析，总结了村内重要节点使用情况、节点间交通组织模式。通过机器学习实现点位聚类，分析节点功能随日期的变化。</p>
<p>通过视频识别技术和数据的处理分析，对全村人口和交通情况展开监测。也对重要节点使用情况做出记录，与Wi-Fi定位结果相验证。对重要公共空间进行特写，对其功能做出评估。</p>
<p>通过多维度的量化分析，本研究总结了两村庄整体和其公共空间的空间行为时空特征。同时，也作为一个技术验证的研究，讨论两技术优势和局限，对其在“采集——处理——分析”的环境行为学研究框架中的前景做出展望。</p>
<p>关键词：中国农村；人居环境；环境行为学；Wi-Fi定位；视频识别 </p>
<p>&nbsp;
 </p>
<h2 id="Abstract"><a href="#Abstract" class="headerlink" title="Abstract"></a>Abstract</h2><p>The betterment of rural living environment is a primary component of contemporary governance, with rural space behavior being its key manifestation. Inspired by the ongoing technological upgrade of environment and behavior studies, making use of Wi-Fi and video data, this article explores the spatial-temporal characteristics of the space behavior at two villages: Jiangjiahutong and Xiaochuanfangyu in Jizhouqu, Tianjin.</p>
<p>Utilizing Wi-Fi positioning technology, processing and analyzing respective data, the article summarizes the usage of important locations and the traffic organization patterns in-between. Machine learning clustering of the locations showcases their changing functionality over time.</p>
<p>Utilizing video recognition technology, processing and analyzing respective data, the article tracks the demographics and traffics of the villages. The usage of important locations is also recorded, consistent with that of the Wi-Fi data. Close-ups at important public spaces are created to assess their functionality.</p>
<p>Through quantitative analysis at different scales, this article summarizes the spatial-temporal characteristics of the space behavior at the two villages and their public spaces. As a technology validation study, it discusses the advantages and limitations of the two technologies as well as their future application in the “collecting-processing-analyzing” framework of environment and behavior studies.</p>
<p>Keywords: rural China; living environment; environment and behavior; Wi-Fi positioning; video recognition<br> <br>&nbsp;
 </p>
<h2 id="目录"><a href="#目录" class="headerlink" title="目录"></a>目录</h2><p>第1章 研究背景 </p>
<p>1.1 农村人居环境和空间行为 </p>
<p>1.2 环境行为学的技术更新 </p>
<p>1.3 研究聚焦：农村空间行为时空特征</p>
<p>第2章 研究对象与方法</p>
<p>2.1 研究对象</p>
<p>2.2 研究方法</p>
<p>第3章 基于Wi-Fi定位的研究方法与分析</p>
<p>3.1 研究方法与原理</p>
<p>3.2 研究方法使用现状</p>
<p>3.3 Wi-Fi数据获取与预处理</p>
<p>3.4 基于单点位的Wi-Fi数据分析</p>
<p>3.5 点位聚类和功能分析</p>
<p>3.6 基于跨点位的Wi-Fi数据分析</p>
<p>3.7 本章小结</p>
<p>第4章 基于视频识别的研究方法与分析</p>
<p>4.1 研究方法与原理</p>
<p>4.2 研究方法使用现状</p>
<p>4.3 视频数据获取与预处理</p>
<p>4.4 作为节点的视频数据分析</p>
<p>4.5 作为场所的视频数据分析</p>
<p>4.6 本章小结</p>
<p>第5章 结论</p>
<p>5.1 技术应用展望</p>
<p>5.2 农村空间行为时空特征</p>
<p>5.3 农村人居环境与治理术</p>
<p>参考文献</p>
<p>致谢</p>
<p>附录</p>
<p>&nbsp;</p>
<h2 id="第1章-研究背景"><a href="#第1章-研究背景" class="headerlink" title="第1章 研究背景"></a>第1章 研究背景</h2><h3 id="1-1-农村人居环境和空间行为"><a href="#1-1-农村人居环境和空间行为" class="headerlink" title="1.1 农村人居环境和空间行为"></a>1.1 农村人居环境和空间行为</h3><p>“农村”总是与“农业”、“农民”一起作为“三农”问题被提起及。我国对“三农”问题的规划，除了强调农产业发展和经济建设，也探索城乡融合发展，实施“乡村建设行动”：要完善基础设施、生活服务，推进环境整治，最终改善农村人居环境(中国共产党第十九届中央委员会, 2020)。</p>
<p>&nbsp;</p>
<p><strong>从农村环境到农村人居环境</strong> 人居环境是包括社会环境、自然环境和人工环境（建筑物内部和外部）的整体(吴良镛, 1989)。农村作为中国广袤大地上散布最广阔的聚落形式，承担了自然环境保护、生态文明建设的角色。农村一二三产业融合发展也使其在环境保护上面临与城市同样的威胁，但缺乏更完善的监督体系。环保工作已成为基层政府五年计划的重要工作内容(周雪光, 2017)。</p>
<p>与对自然环境的保护同步的，是对农村人居环境的治理，对村容村貌的提升，包括生活垃圾治理、庭院环境整治、公共照明设施、绿化等(中共中央办公厅等, 2018)。农村的室外空间与荒野结合更紧密，同时经济水平、设施现代化程度等不及城市，因此在人居环境上面临更多挑战，也更依赖于中央的总体布局协调和基层的组织力量。</p>
<p>人居环境不仅仅是绿化、卫生等条目化的环境治理，它最终服务于人的生活。因此“人居环境”一词有两个更深入的内涵：</p>
<p>一是科学规划、总体保护与利用，更依赖于具体问题具体分析；防止自上而下的“运动式”治理造成的过度开发与资源浪费；难以像污染、能源问题一样形成统一要求。</p>
<p>二是物理环境与社会关系、民俗文化的紧密结合，要使得人居环境契合并引导文明的社会风尚，健康的生活方式。</p>
<p>已有文献研究也多关注于“人居环境”作为物理条件的“环境”一侧，而较少涉及作为规划、生活的“人居”一侧。</p>
<p>&nbsp;</p>
<p><strong>从农村土地到农村空间</strong> 谈论农村人居，绕不开土地。农民一词，本义是依靠农业而生者，农业即需要一定的土地。土地是经济关系在物理空间上的映射。它是农民生存的依托，是农村历史的载体，是乡土社会在物理空间中的编织结构。对于基层政府，土地也是开发、治理的直接物理对象——超前发展，工业区跑马占地、“摊大饼”，最终无力填补的基层单位不在少数(周其仁, 2017)。</p>
<p>从土地到空间的概念转变，是对其经济之外价值的强调，也生发于农民作为土地拥有者的式微(文贯中, 2014)。作为农村空间享用者和拥有者的农民，同样也有部分在“农业”中退出，或是游弋于“农村”之外。这样一种变革中的“三农”问题，在我们的例子中尤其明显。</p>
<p>农村作为空间的意义是长久存在的，它通过空间构成农民的“家”与“园”(张柠, 2013)。农村人居环境的建设，即是要避免空间与“家园”之丧失，通过其提供的生活品质和实践内容来留住其作为“家园”之活力。</p>
<p>&nbsp;</p>
<p><strong>农村空间形态的变革</strong> 乡土社会的变革带来农村空间形态的变革。首先是以公共空间为首的室外空间形态。二十世纪的战争、灾害、发展带来的移民；新中国成立后城镇化，工业化带来的“去组织化”(温铁军, 2016)等，使得宗祠、堂庙等在部分乡村中消失、稀释了。取而代之的是大队部、服务中心、文化礼堂等承载政治和服务功能的同样建筑规模庞大的室内空间。而集市、学堂、晒场等则以商店、学校、广场等形式演化存在。本文研究的两个村庄即充分反映了这样的情况。</p>
<p>承担特定功能的室内公共空间、开放的室外空间、串联空间的道路肌理，以及在使用中表现出公共性的部分私人空间，它们共同构成了农民走出面阔三间的自建房之后所享有的农村空间。</p>
<p>本研究侧重于室外公共空间和道路。通过对村民行为的影响，室外空间的形式、组织对于农村的生产和社会生活具有不亚于经济关系的重要意义。</p>
<p>&nbsp;</p>
<p><strong>建筑学视野</strong> 建筑设计师作为常常与乡村对话的群体，承担的角色更多是设计者、开发者。这些主动性工作即是前述人居环境所需之“量体裁衣”。但以“开发建设”为关键词的乡村振兴，也经常缺少对具体条件的把控，导致过度开发和无效开发，浪费资源。</p>
<p>可达性不足，公共参与的缺失，空间发展理念的迷失，社会功能的弱化，公共议题的失语……这些因素都可能导致农村公共空间的失落(张诚等, 2019)。农村空间的设计规划，即需要基于社会、经济关系因地制宜，也需要数据分析支撑的合理资源配置。本研究即希望做这样一种尝试，以农村空间中的行为为载体，以环境行为学方法，提取其时空特征，最终为管理者和设计者对农村空间的认知提供量化参考。</p>
<p>&nbsp;</p>
<h3 id="1-2-环境行为学的技术更新"><a href="#1-2-环境行为学的技术更新" class="headerlink" title="1.2 环境行为学的技术更新"></a>1.2 环境行为学的技术更新</h3><p><strong>环境行为学</strong> 环境行为学关注于环境与人的外显行为之间的关系与研究(李道增, 1999)。它的基本假设是环境作为人主观性与之互动的物质世界，以各种方式影响人的感觉和精神，最终影响人在环境中的行为。它的研究内容和“环境心理学（Environmental Psychology）”这一概念类似（英语中的行为学一词ethology多指动物的行为学研究），继承了建筑学、心理学、社会学等的研究范式。</p>
<p>建筑师和规划师等，关注于作为设计对象的人居环境，和作为管理与服务对象的人的行为。具体而言：</p>
<p>一是通过环境行为学拟定设计目标，以多学科视野理解使用者的需求；以此基础指导大至规划、城市空间，小至场所、家具的设计；使得设计具有整体性。</p>
<p>二是通过对作为人与环境之因变量的行为的观察研究，对建成环境进行评估，即“使用后评估”（Post-Occupation Evaluation）。作为一的资料提供者，评估似乎是稀松平常的简单任务，但环境行为学的发展已经证明，这种资料的产生必须依赖对“环境”和“行为”的复杂的定义和观察。</p>
<p>&nbsp;</p>
<p><strong>从主观评价到量化评价</strong> 心理学家与社会学家用具体的文字表述感觉，行为。环境行为学在此基础上通过大量案例的综合，以图提炼超越个体的“模式（pattern）”。这是半个多世纪自Lynch(1960)以来设计者一直实践的方法。随着技术的升级和各学科理论的成熟，对行为的研究从主观评价拓展到了量化评价。</p>
<p>&nbsp;</p>
<p><strong>技术更新下的“行为”</strong> 近年来，在采集和处理两方面，环境行为学受益于通信、计算机等技术的发展。<br>例如，在采集方面：利用加速度计，GPS等可穿戴设备采集人的运动情况和地理位置(STEWART等, 2016)；利用定制软件收集使用者对建成环境的评价(ZHOU等, 2016)；利用无人机快速收集短时段内的场地情况(PARK, 2020)等。</p>
<p>在处理方面，则需要将各类原始材料转化为量化评价，更多依赖于计算机程序。本研究所涉及的Wi-Fi数据和视频数据即通过Python和R处理。</p>
<p>机器化的采集和处理使得行走、停留、聚集等空间内的行为更易被批量记录。技术进步同时赋予了仔细审视“行为”更多潜力。以视频识别为例，在针对性布设的高精确性设备，完善的计算机视觉算法的支持下，甚至表情、姿势等细节都可以批量采集并识别。无论是社会学家还是设计师，都有理由关注这场技术更新带来的环境行为学变革。</p>
<p>&nbsp;</p>
<h3 id="1-3-研究聚焦：农村空间行为时空特征"><a href="#1-3-研究聚焦：农村空间行为时空特征" class="headerlink" title="1.3 研究聚焦：农村空间行为时空特征"></a>1.3 研究聚焦：农村空间行为时空特征</h3><p><strong>农村人居的独特性</strong> 传统的乡村生活是一种经验生活。异于城市生活体系对所有人的吸纳和规则化所形成的集体特征(沃斯, 2007)，农民以自我感官体验空间与时间。</p>
<p>我们已经讨论了农村空间的特殊性。农村的时间观念同样值得关注。农民首先持有一种“前现代”的时间观。张柠(2013)将时间分为五种类型，除了机械时间，还包括生态时间、结构时间、节日时间和心理时间。春耕、夏种、秋收、冬藏的农业规律使得农民对生态时间更为敏感。而基层组织的日渐发达也使得结构时间和节日时间处于变化之中。</p>
<p>作息规律、对时间的感知即是农民自发形成的，又在宏观上显示出地域、村庄的独特性。</p>
<p>&nbsp;</p>
<p>本研究将聚焦于空间行为的时空特征：探寻两村庄居民对广场、商店、大队部等重要节点形成的使用规律，聚集模式。借此，对农村人居环境和空间行为的评价、需求做出讨论。同时，也作为一个技术验证的研究，分析此方法的局限性。</p>
<p>&nbsp;
 </p>
<h2 id="第2章-研究对象与方法"><a href="#第2章-研究对象与方法" class="headerlink" title="第2章 研究对象与方法"></a>第2章 研究对象与方法</h2><h3 id="2-1-研究对象"><a href="#2-1-研究对象" class="headerlink" title="2.1 研究对象"></a>2.1 研究对象</h3><p>本文研究对象为华北两个地理上相近，但发展轨迹又殊异的村庄：天津蓟州区蒋家胡同村和小穿芳峪村（图2.1）。</p>
<p>&nbsp;</p>
<center>

<p><img src="/2021/06/08/Wi-Fi-and-Video-Data/image002.jpg" alt> </p>
<p>图2.1 蒋家胡同村和小穿芳峪村区位图</p></center><p></p>
<p>&nbsp;</p>
<p><strong>1. 蒋家胡同村</strong></p>
<p>位于蓟州区西白涧镇，距离蓟州区城区40分钟车程，距离北京城区1小时20分钟车程。毗邻G102国道和京秦高速。清代成村，因位于蓟州区、三河两县交界处，得名“疆界胡同”，民国时期改为“蒋家胡同”。历史上曾经做过兵营、矿区。</p>
<p><strong>人口、土地、产业</strong> 全村121户，户籍人口375人，均为汉族。党员与预备党员共32名，占8.5%。土地面积600余亩，其中耕地面积180亩，林地面积300亩，均为平原。全村主导产业为农业，产盘山柿子、核桃、苹果、玉米、小麦等。务农者以老年人为主。同时亦有40%的人口外出务工，以年轻人为主，主要从事家政、运输、建筑、技术工。因环保政策等因素，村内无企业。</p>
<p><strong>交通</strong> 因蒋家胡同村离北京市区、蓟州区城区较近，毗邻国道和高速，交通便利，外出务工者大多数都住在村内。80%以上的家庭拥有私家车。国道亦有前往北京和蓟州区城区的公交车，但少有人坐。</p>
<p><strong>人居环境</strong> 村里各户基本住在带小院的一层自建房。部分户院内有若干附属房屋。近年主要依靠村内投入款项，进行了自来水供水、路灯布设、道路硬化污水处理、厕所提升等工程，使得村庄人居环境得到很大提升。目前村民日常生活的主要问题是供暖受环境政策约束，不能烧柴，以电供暖为主，开支较大，效果较差。</p>
<p><strong>公共空间</strong> 村内主要公共空间为村大队（党群服务中心）、有健身器材和篮球场的广场（图2.2）。村内还有一个超市。平时广场和篮球场在傍晚使用率较高，也会吸引邻村村民。村内无学校，中小学生靠步行前往邻村上学。节日和红白喜事时很少使用公共空间举办活动。因务工者较多，平时白天村内很少见30岁以下的年轻人，主要为老年人和孩子。</p>
<p>&nbsp;</p>
<center>

<p><img src="/2021/06/08/Wi-Fi-and-Video-Data/image003.jpg" alt></p>
<p>图2.2 蒋家胡同村大队部和广场</p></center><p></p>
<p>&nbsp;</p>
<p>蒋家胡同村是一个典型的平原劳务输出村，没有足够的自然环境和文化特色以开发旅游业，也没有政策对村办企业的支持。但得益于京津冀城市群的辐射和便利的交通，蒋家胡同村的年轻人在务工方面有更多选择和更少的担忧。</p>
<p>京津冀地区是中国卡车司机户口分布最多的地方(传化慈善基金会公益研究院“中国卡车司机调研课题组”, 2018)。在102国道，每天有数不清的卡车经过。蒋家胡同村便是卡车沿途连绵的平凡的村庄的一个缩影。</p>
<p>&nbsp;</p>
<p><strong>2. 小穿芳峪村</strong></p>
<p>位于蓟州区东北穿芳峪镇，距离蓟州区城区40分钟车程，距离遵化城区1小时20分钟车程。距离G230国道2公里。</p>
<p><strong>人口、土地、产业</strong> 全村82户，户籍人口275人，除两户为满族外均为汉族。党员与预备党员共22名，占8%。土地面积762亩，其中耕地面积123亩，山地林场面积344亩。全村主导产业为旅游业，也有少数务工者。自2012年起，村里走出去的企业家返乡担任村书记，带领小穿芳峪村开启了新村建设，房屋、路面、桥等都得到了重建和改造。2014年起成立旅游业开发的集体企业，依托山地自然资源和苗木培育积累的绿化环境等优势，走上了文化旅游乡村振兴之路，成为了天津市有名的旅游特色村。目前，村庄累积投资3600万元，包括政策支持2200万元。以门票、接待、精品民宿等旅游业收入为主，2020年人均年收入达到39000元。游客大多来自天津，也有部分来自于北京和河北。散客和团队游客比例约为5:4。节假日游客可达1000-1500人，年接待游客和参观学习人员6万人次。</p>
<p><strong>交通</strong> 与蒋家胡同村条件类似。村口有生态停车场停放村民的私家车，以及旅游大巴和游客的私家车。</p>
<p><strong>人居环境</strong> 村里各户同样住在带小院的一层自建房。作为精品民宿的自建房由集体与农户合作搭建，仿清代风貌，设施齐全，约有20户。部分还有屋顶花园。其余农居则与蒋家胡同村类似，但条件略好。虽然村民收入很高，但出于风貌考虑，全村无二层建筑。村庄整体环境亦较好。得益于在苗木培育领域的经验，绿化较完善。沿主要道路亦有不少配套座椅，廊架（图2.3）。</p>
<p>&nbsp;</p>
<center>

<p><img src="/2021/06/08/Wi-Fi-and-Video-Data/image004.jpg" alt></p>
<p>图2.3 小穿芳峪村街道环境</p>
<p>来源：作者摄，郑凯文摄</p></center><p></p>
<p>&nbsp;</p>
<p><strong>公共空间</strong> 村内主要公共空间为村大队（党群服务中心）、老街广场。与蒋家胡同村相比，面积较小，健身器材较少。还有一个超市。村口有篮球场，几个村共用。过年时举办全村聚餐活动。红白喜事则从简办理。以乡野公园为载体的景区也是村庄公共空间的一部分，但其位于村庄边缘，主要面向游客，本研究暂不涉及。</p>
<p>小穿芳峪村位于平原和山区交接之地，兼有两者之优势，是华北山区旅游村的一个领头羊。自身的自然条件、乡贤的担当、政策的扶持共同打造了这一个明星村。不可否认它是成功的，但乡村振兴的大潮之下，更要对它的模式的合理性、可持续性和可复制性做更多审视。</p>
<p>&nbsp;</p>
<center>

<p><img src="/2021/06/08/Wi-Fi-and-Video-Data/image005.jpg" alt></p>
<p>图2.4 蒋家胡同村和小穿芳峪村地图</p>
<p>来源：蒋家胡同村、小穿芳峪村提供，作者改绘</p></center><p></p>
<p>&nbsp;</p>
<p><strong>3. 两村共同特点</strong></p>
<p>在建筑和规划视角之下，两村也有共同的特点。</p>
<p>首先，两村与邻村、城际交通干道的拓扑关系类似。村庄是连绵分布的，但各自到公路的距离都很近，沿公路呈“鱼骨状”分布，都有一个主要的入口（图2.4）。这是整体呈现出人口高密度分布的华北平原的特征。邻近的村庄联系紧密，少有偏僻难至的村庄。</p>
<p>人居环境上，村与村更多共享篮球场、商店、餐馆等公共场所和消费场所。而学生的上下学更是带来了规律的村际互动。</p>
<p>产业上，这种紧密的联系带来了产业聚集之势。蒋家胡同村和邻近村都输出了许多大车司机。小穿芳峪村周边村庄也孕育了农产品采摘、农家民宿的产业。</p>
<p>此外，两村的尺度相当，耕地面积、林地面积和其余住宅等用地的面积也分别大致相当。因此，依托于用地分类的村庄规划是可以相互借鉴，形成可重复的模式的。</p>
<p>&nbsp;</p>
<h3 id="2-2-研究方法"><a href="#2-2-研究方法" class="headerlink" title="2.2 研究方法"></a>2.2 研究方法</h3><p>团队通过实地考察走访、访谈村干部和村民，建立了对村庄的整体了解。在此基础上依托Wi-Fi定位和视频识别进行量化研究。</p>
<p>Wi-Fi定位技术能提供对时空特征的长时间追踪，视频识别则提供聚焦于节点的行为的特征识别和追踪。具体技术方法将在以下两章介绍。图2.5介绍了本研究框架。本研究对于空间行为的时空特征之聚焦，即通过在这两处特点鲜明、有代表性的研究地段所采集的数据的处理和分析实现。</p>
<p>&nbsp;</p>
<center>

<p><img src="/2021/06/08/Wi-Fi-and-Video-Data/image006.png" alt></p>
<p>图2.5 研究框架</p></center><p></p>
<p>&nbsp;
 </p>
<h2 id="第3章-基于Wi-Fi定位的研究方法与分析"><a href="#第3章-基于Wi-Fi定位的研究方法与分析" class="headerlink" title="第3章 基于Wi-Fi定位的研究方法与分析"></a>第3章 基于Wi-Fi定位的研究方法与分析</h2><h3 id="3-1-研究方法与原理"><a href="#3-1-研究方法与原理" class="headerlink" title="3.1 研究方法与原理"></a>3.1 研究方法与原理</h3><p>Wi-Fi即无线通信技术。以手机为代表的通过Wi-Fi联网的移动设备，在打开Wi-Fi开关时即会搜索附近的接入点（Access Point，AP）。即使并不连接对应的Wi-Fi网络，移动设备也会与该AP产生一次“握手”，告知对方自己的媒体存取控制地址（Media Access Control Address，MAC地址）。MAC地址由生产商烧录在移动设备的网卡中，是移动设备联接Wi-Fi网络的身份识别依据。通过MAC地址可以获得移动设备的生产商信息。</p>
<p>这意味着如果AP持续记录握手信息，即可记录下移动设备的出现，离开。并通过多AP组成的网络实现跨AP的捕捉，追踪同一用户不同时刻的大致位置。</p>
<p>&nbsp;</p>
<h3 id="3-2-研究方法使用现状"><a href="#3-2-研究方法使用现状" class="headerlink" title="3.2 研究方法使用现状"></a>3.2 研究方法使用现状</h3><p>行为研究所应用定位技术的场景主要可以分为室内和室外两种。</p>
<p>室内场景更追求精确性，常用的技术如射频识别（Radio Frequency Identification，RFID）、超宽带（Ultra Wide Band，UWB）技术、蓝牙(Bluetooth)等。它们对接受设备的布置、研究对象携带特定设备都有严格要求，不适合于本研究面向的村域尺度。</p>
<p>而室外研究则追求易布施性和易采集性。常用无需佩戴特殊设备的室外定位技术如全球定位系统（Global Positioning System，GPS）和蜂窝网络（Cellular network）定位等。用户的位置以手机信令数据的形式，通过运营商或者软件（如百度地图）得到采集。此类定位技术成本低，采集规模广，但精度较差，或需要特定采集数据权限。更多是作为一种人数统计的手段。</p>
<p>&nbsp;</p>
<p>“Wi-Fi定位”一词通常指的是基于多AP共同定位实现的室内定位技术(HE等, 2016)。配合三角算法、指纹算法、非RSSI算法等，在无遮挡的室内条件下可以较精准地定位用户，且无需用户配戴特殊设备。</p>
<p>本研究作为室外的村域研究，无法按室内多AP共同定位所需的密度布置AP，且室外房屋遮挡严重，多AP共同定位精度大打折扣。所以本研究的Wi-Fi定位技术具体采用的定位算法是类似于蜂窝网络定位技术的原点小区（Cell of Origin，COO）算法(BAI等, 2014)。即将用户在某一时刻分配到一个AP作为其位置。而误差即是该用户实际与AP位置的距离（图3.1）。这是一种朴素易用的在更大尺度下通过Wi-Fi实现大致定位的算法。也符合本研究利用Wi-Fi将移动设备定位到具体节点的目标。</p>
<p>&nbsp;</p>
<center>

<p><img src="/2021/06/08/Wi-Fi-and-Video-Data/image007.jpg" alt></p>
<p>图3.1 Wi-Fi定位技术对比</p></center><p></p>
<p>&nbsp;</p>
<p>补充说明：当移动设备同时与多AP握手时，根据握手频率和接收信号强度（Received Signal Strength Indicator，RSSI）将用户分到某一确定的AP。在信号强度不受地形影响，忽略系统误差的理想情况下，地图会以AP为样点按泰森多边形的方式形成分区，使得每个分区内的所有点，到该样点的距离比其他样点都更近（图3.2）。泰森多边形对定位问题具有一定参考价值(OKABE等, 1997)。当AP点按正三角形密铺排布时，对应的泰森多边形图案即呈正六边形密铺，这就是“蜂窝网络”一词的来源。而本研究按重要场所、节点布设AP。因泰森多边形分区只是理想情况，本研究对移动设备的持续定位和追踪仍然以对应到节点的概括性描述为主，不参照此分区。</p>
<p>&nbsp;</p>
<center>

<p><img src="/2021/06/08/Wi-Fi-and-Video-Data/image008.jpg" alt></p>
<p>图3.2 以蒋家胡同村的AP布设绘制的泰森多边形分区</p></center><p></p>
<p>&nbsp;</p>
<p>本研究同时也涉及Wi-Fi定位前的识别设备、筛选数据步骤。需要剔除非手机设备。也有一些手机（如苹果手机），使用随机生成的MAC地址，并不定时更换(MATTE等, 2016)，导致研究的样本并不完全。</p>
<p>&nbsp;</p>
<p>总结而言，本研究采用单AP的Wi-Fi定位技术和COO算法。</p>
<p>其优点有：易布施接收设备，无需特制移动设备，采集面广，算法简单。</p>
<p>缺点有：仅能将移动设备识别到点位。受AP点位密度和室外障碍的影响，精度有限。随机MAC地址的存在造成少数数据缺失。</p>
<p>下一节将更详细地介绍AP点位布设和Wi-Fi数据获取、处理的步骤。</p>
<p>&nbsp;</p>
<h3 id="3-3-Wi-Fi数据获取与预处理"><a href="#3-3-Wi-Fi数据获取与预处理" class="headerlink" title="3.3 Wi-Fi数据获取与预处理"></a>3.3 Wi-Fi数据获取与预处理</h3><p><strong>AP布设</strong> 本研究在蒋家胡同村布置了8个AP点位，在小穿芳峪村布置了3个AP点位（图3.3）。点位布设尽量涵盖村庄重要节点和主要出入口，同时也受到客观条件的限制（表3.1，图3.4）。</p>
<p>&nbsp;</p>
<center>

<p><img src="/2021/06/08/Wi-Fi-and-Video-Data/image009.png" alt></p>
<p>图3.3 AP设备示意</p>
<p>来源：作者摄，熊鑫昌摄</p></center><p></p>
<p>&nbsp;</p>
<p><strong>数据接收</strong> 各AP每日24小时不间断收集握手数据后自动上传至云服务器。本研究一共收集了2020年12月29日至2021年5月6日四个多月的数据，涵盖春节和五一假期。小部分AP曾中途停止工作一段时间，在影响到后续统计结果时将加以说明。<br>本研究的数据处理部分均使用Python和R完成。每个AP每六小时打包一个压缩文件。远程下载并解包后合并各AP记录。</p>
<p><strong>删除无效数据</strong> 根据MAC地址的前六位，可以获知移动设备的生产商，只保留生产商是手机厂商的记录。随机MAC地址前六位亦是随机的，因此也被删除。此外，根据电气电子工程师学会的规定(IEEE COMPUTER SOCIETY, 2016)，MAC第二位是“2”、“6”、“a”、“e”的是随机MAC的特征(CISCO DNA CENTER, 2020)。据此特征再做一遍筛选。本步骤一共剔除约90%无效数据。</p>
<p><strong>时间窗压缩</strong> 移动设备在稳定情况下与AP每隔5秒握手一次。研究要求在连续的每一个时间窗将移动设备定位到一个唯一、确定的AP。经对比，选用时间窗长度为5分钟。对于在一个时间窗内与多个AP握手的情况，优先比较握手频率，其次比较RSSI，具体算法可见附录B。</p>
<p>&nbsp;</p>
<p>表3.1 AP设备布设情况</p>
<table>
<thead>
<tr>
<th>识别号</th>
<th>点位名称</th>
<th>描述</th>
</tr>
</thead>
<tbody><tr>
<td>006ce4</td>
<td>蒋家胡同1</td>
<td>次出入口</td>
</tr>
<tr>
<td>00fb64</td>
<td>蒋家胡同2</td>
<td>主出入口</td>
</tr>
<tr>
<td>013574</td>
<td>蒋家胡同3</td>
<td>村大队</td>
</tr>
<tr>
<td>006a7c</td>
<td>蒋家胡同4</td>
<td>几何中心南</td>
</tr>
<tr>
<td>010268</td>
<td>蒋家胡同5</td>
<td>超市</td>
</tr>
<tr>
<td>010b90</td>
<td>蒋家胡同6</td>
<td>上学路口</td>
</tr>
<tr>
<td>006bb0</td>
<td>蒋家胡同7</td>
<td>几何中心北</td>
</tr>
<tr>
<td>010b5c</td>
<td>蒋家胡同8</td>
<td>村边界</td>
</tr>
<tr>
<td>0134d4</td>
<td>小穿芳峪1</td>
<td>主出入口;停车场</td>
</tr>
<tr>
<td>006c98</td>
<td>小穿芳峪7</td>
<td>村大队</td>
</tr>
<tr>
<td>006cc4</td>
<td>小穿芳峪8</td>
<td>售票处</td>
</tr>
</tbody></table>
<p>&nbsp;</p>
<p><img src="/2021/06/08/Wi-Fi-and-Video-Data/image010.jpg" alt><br><img src="/2021/06/08/Wi-Fi-and-Video-Data/image011.jpg" alt></p>
<p>图3.4 Wi-Fi点位（AP）和摄像头布置情况</p>
<p>&nbsp;</p>
<p><strong>初步标识</strong> 将日期标记为工作日、周末和节假日三类。</p>
<p>根据MAC出现的情况也可以对移动设备机主进行分类（例如稳定的本地居民，重复出现的访客或务工人员，短期出现的游客）。分别统计机主总出现日数、最长连续出现日数、出现日期区间长度（即第一次与最后一次出现的跨度），发现除总出现日数在90%以上的机主分布较为集中外，分布曲线整体平滑（图3.5）。总出现日数在90%以上的机主数量与全村人口相比仍较少，因此需要更宽松的本地机主标准。出现日期区间长度在接近100%时分布亦较为集中，但该值仅在较小时可作为定期路过的判断依据。因该值整体较高，难以作为筛选依据。最终根据作后续统计图的结果对比，按经验值将机主分为三类：本地机主（出现日数&gt;30%），访客机主A（出现日数&gt;1），访客机主B（出现日数=1）。</p>
<p>&nbsp;</p>
<center>

<p><img src="/2021/06/08/Wi-Fi-and-Video-Data/image012.jpg" alt></p>
<p>图3.5 机主出现日数（Wi-Fi）统计图</p></center><p></p>
<p>&nbsp;</p>
<p>至此，Wi-Fi数据预处理完毕。因数据量大，在初步标识前，分若干文件按以上算法压缩，然后合并。</p>
<p>&nbsp;</p>
<h3 id="3-4-基于单点位的Wi-Fi数据分析"><a href="#3-4-基于单点位的Wi-Fi数据分析" class="headerlink" title="3.4 基于单点位的Wi-Fi数据分析"></a>3.4 基于单点位的Wi-Fi数据分析</h3><p>基于单点位的Wi-Fi数据分析，即包括对每个点位作为村庄节点的分析，也包括将一个村庄所有点位作为整体的分析。</p>
<p>&nbsp;</p>
<p><strong>每日流量</strong> 对全村每日记录下的机主数量作统计，可以监测村庄人口变化。蒋家胡同村的本地机主稳定在300上下，符合全村总人口375（图3.6）。</p>
<p>&nbsp;</p>
<center>

<p><img src="/2021/06/08/Wi-Fi-and-Video-Data/image013.jpg" alt> </p>
<p>图3.6 蒋家胡同村每日流量图（Wi-Fi）（全村、点位1、2）</p></center><p></p>
<p>&nbsp;</p>
<p>无论是全村还是单个点位，根据三种机主的变化情况都可以判断数据异常之处是否是由数据缺失造成的。举例来说，全村3月27日和4月27日三种机主数量都断崖式下跌，说明设备出故障造成数据缺失；而1月13日至1月19日仅访客机主数据大幅下跌，说明可能不是数据缺失。经查，这一情况只出现在了点位1、2，离国道最近的点位，推测是往来车辆减少所致（与其他点位相比，因往来车辆影响，平时点位1、2的访客机主数也显著更多）。1月3日起，河北爆发了一轮新型冠状病毒（图3.6）。白涧镇是蓟州通往北京、河北的西大门，1月14日起，包括蒋家胡同所在的白涧镇等蓟州区各乡镇开启道口车辆管控、查验，导致了102国道的车流量锐减。而流量图记录到蓟州实施管控的前一天，13日流量已经锐减，说明货车司机和私家车主可能通过各种渠道提前得知了管控政策，或是受其他地区管控而减少了活动。1月19日，河北每日新增确诊病例降到20人以下，第二天开始，记录到的流量也恢复正常。</p>
<p>另一处异常值在春节期间，尤其是除夕（2月11日）和大年初一（2月12日），访客机主流量较低。推测是途径的货车司机放假导致。</p>
<p>&nbsp;</p>
<center>

<p><img src="/2021/06/08/Wi-Fi-and-Video-Data/image014.jpg" alt></p>
<p>图3.7 小穿芳峪村每日流量图（Wi-Fi）（全村、点位7、8）</p></center><p></p>
<p>&nbsp;</p>
<p>小穿芳峪村因AP较少，且有长时间停止工作的情况，导致其全村流量图分明显的三段（图3.7）。根据第一段可以看到本地机主稳定在60上下，这明显小于全村人口275人。这是小穿芳峪村点位少，覆盖范围小导致的。</p>
<p>点位7、8分别是村大队和售票处。售票处即景区“小穿乡野公园”入口。而村大队则是根据指示牌前往售票处的必经之路。小穿乡野公园在3到4月份曾经历修缮，之后重新开放。结合全村和点位7、8流量可以看到，从元旦到春节，到清明，最终到五一：在这些节假日以及周末，小穿芳峪村的游客访问量不停创下新高。</p>
<p>&nbsp;</p>
<p><strong>到达离开时间</strong> 每日到达和离开某一节点的时间可以反应作息规律。图3.8横轴是一个移动设备某一天第一次达到该节点的时间，纵轴是离开该节点的时间。同时绘制了到达时间和离开时间的分布情况。以蒋家胡同为例，记录许多路过汽车的点位2在工作日、周末和节假日的区别不大。访客机主的到达和离开时间从6至18点几乎均匀分布，可以视为路过汽车的规律。本地机主主要在8点左右到达作为全村主出入口的点位2 ，在17点左右离去，说明这些是早上出村、晚上回村的主力，进城务工者的作息。相比之下，村大队部更多人在9点左右达到，晚饭前离开。节假日有一部分人在9点左右达到村大队后不久就离开了，推测是节假日村内集中办理手续（如打疫苗，派发物资）。而作为上学路口的点位6，许多孩子在7点左右即被记录到，但仅限于工作日。再观察下午，可以发现周末下午有不少人来到村大队，很可能是本村和邻村来打篮球、跳广场舞的村民，而节假日则没有此现象。</p>
<p>&nbsp;</p>
<center>

<p><img src="/2021/06/08/Wi-Fi-and-Video-Data/image015.jpg" alt> </p>
<p>图3.8 蒋家胡同村到达离开时间图（Wi-Fi）（点位2、3、6）</p></center><p></p>
<p>&nbsp;</p>
<p><strong>单日流量变化</strong> 计算各节点每日各时刻平均流量，分机主类型和日期类型（工作日、周末或节假日）绘制一系列的流量变化图（纵轴为每个时间窗的平均值，即5分钟平均值）。首先将原始曲线（图3.9虚线）进行宽度为1小时的滑动均值滤波（Moving Average Filter）处理，得到更为平滑的曲线（图3.9实线）。因观察发现一些节点在中午有最短一小时左右流量骤跌，故均值的时间宽度不宜大于此值。</p>
<p>&nbsp;</p>
<center>

<p><img src="/2021/06/08/Wi-Fi-and-Video-Data/image017.jpg" alt></p>
<p>图3.9 单日流量图（Wi-Fi）特征点提取示意</p></center><p></p>
<p>&nbsp;</p>
<p>观察发现一些节点在节假日和平时区别很大，另一些节点的曲线很相似等情况。节点的流量曲线是它实际承担功能的因变量。以下将使用无监督的机器学习（Unsupervised Machine Learning）方法对不同曲线（此处曲线指一个节点一个日期类型对应的一张单日流量变化图）进行聚类（Clustering），观察其结果并进一步分析。</p>
<p>&nbsp;</p>
<h3 id="3-5-点位聚类和功能分析"><a href="#3-5-点位聚类和功能分析" class="headerlink" title="3.5 点位聚类和功能分析"></a>3.5 点位聚类和功能分析</h3><p><strong>K-Means聚类</strong> K-Means（K均值）是一种经典、简洁的聚类算法。它是一个迭代划分的过程，主要基于样本点之间距离来判定相似性。</p>
<p>此类非周期的函数曲线并非常见的无监督聚类对象，需要相应的预处理，压缩提取一系列特征。观察发现中午前后许多节点会分别引来两次流量高峰。但其高度和时间各不相同。以14点为界，提取所有曲线的两次最高的“波峰”坐标，然后提取两“波峰”之间最低的“波谷”坐标（图3.9）。对于数据较充足的本地机主和访客机主A，各有这3个特征点。</p>
<p>提取坐标之前，曲线已经过归一化，即使其均值为1（图3.9未表达），同时记录下三种机主的全日平均流量值。3个流量平均值和6个特征点对应的12个数值一共是15个变量。所有曲线均预处理后，再将各变量标准化（即使其服从μ=0, σ=1的正态分布），作为K-Means方法进行无监督聚类的变量。调节参数对比后发现分为五类时效果最好（图3.10，图3.11）。</p>
<p>&nbsp;</p>
<center>

<p><img src="/2021/06/08/Wi-Fi-and-Video-Data/image018.jpg" alt> </p>
<p>图3.10 k=5时单日流量变化曲线的K-Means聚类结果</p>
<p>注：横纵坐标为主成分分析（Principal Components Analysis，PCA）结果</p>
<p>&nbsp;</p>
<p><img src="/2021/06/08/Wi-Fi-and-Video-Data/image019.jpg" alt></p>
<p>图3.11 根据K-Means聚类结果重绘的单日流量变化典型曲线</p>
<p>&nbsp;</p>
<p><img src="/2021/06/08/Wi-Fi-and-Video-Data/image020.jpg" alt></p>
<p>图3.12 不同日期下点位类型变化情况</p>
<p>&nbsp;</p>
<p><img src="/2021/06/08/Wi-Fi-and-Video-Data/image021.jpg" alt></p>
<p>图3.13 点位类型解释和代表点位曲线</p></center><p></p>
<p>&nbsp;</p>
<p><strong>功能分析</strong> 根据无监督学习的结果，对比节点实际承担的功能和区位，可以总结出每个类型承担的具体功能（图3.11，图3.13）。回顾其实际意义，可以得到如下结论：</p>
<p>在机器学习聚类的帮助下，可以根据每日流量曲线判断节点承担的功能。判断的主要依据是上午和下午流量达到的最大值和时间，中午流量达到最小值的时间，以及对应的访客机主的整体流量。</p>
<p>这帮助我们发现一些节点比其他节点更为重要，如作为上下学路口的蒋家胡同点位6，始终比其余路口更具人气，是重要内部道路（图3.12）。以及观察不同日期下点位类型的变化情况，例如蒋家胡同点位6（村大队）在节假日“退化”为普通内部道路，而点位7平时是普通内部道路，在周末则“升级”为重要内部道路（图3.12）。</p>
<p>（注：对于曲线聚类，亦可将其作为图像通过深度学习进行。）</p>
<p>&nbsp;</p>
<h3 id="3-6-基于跨点位的Wi-Fi数据分析"><a href="#3-6-基于跨点位的Wi-Fi数据分析" class="headerlink" title="3.6 基于跨点位的Wi-Fi数据分析"></a>3.6 基于跨点位的Wi-Fi数据分析</h3><p><strong>质心计算</strong> 质心是描述地理对象空间分布的一个重要指标(王汶, 2010)。在点位密布，无真空区域的前提下，可以根据每个点的质量计算村庄的质心（图3.14）。此处每个点质量定义为所有本地机主的日均总在线时间。可以看到点位7在周末重要性增加，点位6始终较为重要等结论符合单日流量变化一节的分析。计算得村庄质心在点位4附近。</p>
<center>

<p><img src="/2021/06/08/Wi-Fi-and-Video-Data/image022.jpg" alt></p>
<p>图3.14 蒋家胡同村质心计算（Wi-Fi）</p></center><p></p>
<p>&nbsp;</p>
<p><strong>点位间流量</strong> 用户在不同点位被依次捕捉时，即获知了其移动情况。统计不同时间、日期的点位间整体流量情况，可绘制点位间流量图（图3.15）。在点位较密集、设备缺失值少的蒋家胡同村，这反映了不同点位间的联系强度和随时间的使用情况变化。其中各点位饼图为每小时记录下的不同机主数目均值，因此，此处反映的是点位作为居民途径地点的交通属性，与图3.13的大小关系相异。</p>
<p>以图3.15通过蒋家胡同村主出入口点位2 出村的情况为例，可发现靠南边的路径（3→2，4→2）在下午和傍晚流量更大，而靠北和靠村庄东边界的路径（4→6→2）则在上午和下午都有不少流量。这可以作为3号点位大队部和篮球场在下午和傍晚得到更多使用的补充说明。</p>
<p>&nbsp;</p>
<center>

<p><img src="/2021/06/08/Wi-Fi-and-Video-Data/image023.jpg" alt></p>
<p>图3.15 蒋家胡同村点位间流量图和部分点位间流量变化情况（Wi-Fi）</p></center><p></p>
<p>&nbsp;</p>
<p>若在蒋家胡同村和相邻村庄布设更完整的网络，可以提炼更多不同的流量变化模式、得到更完整的村庄联系网络。这是跨点位的Wi-Fi数据分析的潜力所在。</p>
<p>&nbsp;</p>
<h3 id="3-7-本章小结"><a href="#3-7-本章小结" class="headerlink" title="3.7 本章小结"></a>3.7 本章小结</h3><p>本章采用的基于Wi-Fi的定位、统计分析方法具有易于布设、采集和维护的特点。通过单点位和跨点位的数据分析，可以对全村作为整体的人口情况进行监测，也可以对村庄重要节点的使用情况加以追踪。</p>
<p>作为一个应用方法验证的研究，本章提供了基于Wi-Fi的一个村庄监测与研究的框架。当对所作图像的观察与我们对村庄整体的了解相结合时，我们能够在不同维度上得到关于农村空间行为的时空特征的结论。这些结论是村庄社会生活如何开展、村庄环境和设施规划如何合理化的重要参考。</p>
<p>&nbsp;</p>
<p>具体在本研究所涉及的两个村子上，基于Wi-Fi定位的数据分析推导出了如下结论：</p>
<p>村庄整体人流量受节日、政策的影响，随日期变化显著。通过对机主进行分类，能体察事件对本地村民、邻村村民和游客等人群的不同影响。</p>
<p>在一天之内，各节点的流量变化呈现出若干重复的模式，聚类分析展示了这些场所随日期变化，承担的功能、角色也发生转变。<br>通过数据和对村庄信息的对照，可以获知各节点的特点。例如：蒋家胡同村村庄运动设施在周末傍晚吸引邻村村民。节假日村大队作为手续办理场所，在上午使用率更高。在小穿芳峪村，与单日游的游客相比，住宿的游客晚上19仍然造访景区，景区在晚上也得到充分利用。</p>
<p>&nbsp;</p>
<p>受制于本研究较小的样本数量，定位网络对其背后的空间和社会网络的挖掘深度有限。在更大空间和时间范围的研究中，定位精度要求相对较低，室外Wi-Fi定位方法因而能最大化发挥其优势，具有较高研究潜力。</p>
<p>&nbsp;
 </p>
<h2 id="第4章-基于视频识别的研究方法与分析"><a href="#第4章-基于视频识别的研究方法与分析" class="headerlink" title="第4章 基于视频识别的研究方法与分析"></a>第4章 基于视频识别的研究方法与分析</h2><h3 id="4-1-研究方法与原理"><a href="#4-1-研究方法与原理" class="headerlink" title="4.1 研究方法与原理"></a>4.1 研究方法与原理</h3><p>基于视频图像，对行人、车辆等对象进行检测、识别和追踪是计算机视觉（Computer Visual，CV）领域多年来不停探索、优化的领域(汤义, 2010)。检测和识别（Detection and Identification）即在视频帧的画面中发现所关注类型的对象（如行人）并获得其在画面中的位置；追踪（Tracking）即随着视频的时间向前，能够对对识别对象进行重识别（Re-Identification），获知其连续的状态。</p>
<p>视频图像通过投影变换可以对应到平面上的物理空间，因此通过视频识别可以对一个空间范围内的行人、车辆等进行持续追踪。它不仅能实现站岗的人手动记录往来交通情况所发挥的功能，更能自动地计算出其坐标、速度，甚至是朝向、体态、表情等细节。</p>
<p>&nbsp;</p>
<h3 id="4-2-研究方法使用现状"><a href="#4-2-研究方法使用现状" class="headerlink" title="4.2 研究方法使用现状"></a>4.2 研究方法使用现状</h3><p>监控视频是以人群为对象，采集视频图像最常见的形式。无论是作为管理还是科研的工具，它都有着广泛的应用。政府作为监控视频的合法使用者，利用其作为治安、侦查的工具(武亚军, 2015)。而随着人工智能技术成熟之后，监控视频的作用也愈加强大，能够实现对异常事件进行预警、对可疑人员进行跟踪等(曾婷等, 2021)，广泛运用于银行、电梯、景区、体育场馆等特殊场所。</p>
<p>作为对人群的统计工具，视频图像技术也应用于公共交通管理(蒋晓峰, 2013)、客流管理(梁英宏等, 2008)。</p>
<p>视频识别技术也应用于各种创新产品。日趋发展的智能汽车、智能家居等产业不断对视频识别技术的速度、准确度等性能提出更高要求。</p>
<p>&nbsp;</p>
<p>本研究即利用了以行人和车辆为主要检测对象的视频识别技术。</p>
<p>通常视频识别并不被称作是一种“定位”技术。受图像分辨率所限制，单个摄像头所能捕获的空间范围和识别对象的清晰程度两者是不可兼得的。因此单个监控视频的范围一般最大也仅限于路口大小。</p>
<p>农村的人口密度不及城市，但同样容易滋生盗窃、暴力等犯罪。因此近年来各地都在自发搭建室内外的村庄治安监控网络。尺度相对微小的村庄道路空间和公共空间适合监控视频捕获范围小这一特点。角度合适的监控视频可以完整记录下一个村庄广场或者重要路口。使我们能通过监控视频图像即对村庄重要场所和路口进行详实完整的记录。</p>
<p>&nbsp;</p>
<h3 id="4-3-视频数据获取与预处理"><a href="#4-3-视频数据获取与预处理" class="headerlink" title="4.3 视频数据获取与预处理"></a>4.3 视频数据获取与预处理</h3><p><strong>摄像头选取和数据保存</strong> 蒋家胡同村和小穿芳峪村都搭建了完整的监控视频系统。得益于本次课题安排，本研究可以利用两个村的监控摄像头数据。</p>
<p>蒋家胡同村使用“萤石云”联网摄像头，数据实时存储在摄像头内的存储卡，并向前覆盖，保存时间15天左右。摄像头通过村内的公共Wi-Fi联网，在村大队部电脑的“萤石工作室”软件可实时调取。手动拷贝视频数据需要从摄像头中的存储卡在线下载。受限于网络速度和设备联网速率，下载速率较慢，一段视频所需下载时间略短于视频实际时长。</p>
<p>小穿芳峪村使用“海康威视”摄像头和硬盘录像机（图4.1）。数据通过村内布设的信号线实时写入中控室的硬盘录像机中，保存时间20天左右。调取查看的响应速度、拷贝视频的传输速度都显著快于蒋家胡同村的在线联网方案。</p>
<p>&nbsp;</p>
<center>

<p><img src="/2021/06/08/Wi-Fi-and-Video-Data/image024.jpg" alt><br><img src="/2021/06/08/Wi-Fi-and-Video-Data/image025.jpg" alt></p>
<p>图4.1 小穿芳峪村监控摄像头和控制台</p></center><p></p>
<p>&nbsp;</p>
<p>蒋家胡同村共有摄像头15个。小穿芳峪村共有摄像头21个（不包括释室内摄像头和景区摄像头）。两村摄像头数量都不少，但布设上都存在有一定重复性、部分镜头画面无意义（例如正对一大堵墙，难以捕捉行人）等问题。同时两村的摄像头都有不小的故障率，尤其蒋家胡同村的摄像头经常中途停止工作一段时间，记录下的视频断断续续。考虑到以上原因，结合Wi-Fi点位分布，亦受本研究的算力和时间限制，实际共选取了两村10个摄像头的数据拷贝处理（表4.1，图3.4）。分两类：A类，公共空间或游客出口，取工作日、周末、节假日三个典型日的视频数据（5月2、9、10日）；B类，主要点位或道路，取工作日一个典型日（5月10日）。每日取7-19点的视频数据。</p>
<p>&nbsp;</p>
<p>表4.1 摄像头选取情况</p>
<table>
<thead>
<tr>
<th>识别号<sup>i</sup></th>
<th>点位名称</th>
<th>平台内名称</th>
<th>分类</th>
<th>描述</th>
</tr>
</thead>
<tbody><tr>
<td>D36114895</td>
<td>蒋家胡同1</td>
<td>大队东</td>
<td>A</td>
<td>大队部前广场</td>
</tr>
<tr>
<td>D36114685</td>
<td>蒋家胡同7</td>
<td>周浩前门南</td>
<td>B</td>
<td>主出入口</td>
</tr>
<tr>
<td>D36114852</td>
<td>蒋家胡同8</td>
<td>周凤林家门口西</td>
<td>B</td>
<td>次出入口</td>
</tr>
<tr>
<td>D36115235</td>
<td>蒋家胡同9</td>
<td>周建住北</td>
<td>B</td>
<td>上学路口，对应Wi-Fi 6</td>
</tr>
<tr>
<td>D36114772</td>
<td>蒋家胡同10</td>
<td>刘永后门南</td>
<td>B</td>
<td>村庄边缘</td>
</tr>
<tr>
<td>D36114819</td>
<td>蒋家胡同11</td>
<td>王兴华北</td>
<td>B</td>
<td>村庄边缘</td>
</tr>
<tr>
<td>2-3</td>
<td>小穿芳峪3</td>
<td>村委主街口南</td>
<td>B</td>
<td>村大队，对应Wi-Fi 7</td>
</tr>
<tr>
<td>21-13</td>
<td>小穿芳峪13</td>
<td>老街南03</td>
<td>B</td>
<td>村庄主干道</td>
</tr>
<tr>
<td>17-18</td>
<td>小穿芳峪18</td>
<td>老街广场</td>
<td>A</td>
<td>村民主公共空间</td>
</tr>
<tr>
<td>缺失-19</td>
<td>小穿芳峪19</td>
<td>售票亭前</td>
<td>A</td>
<td>售票处，对应Wi-Fi 8</td>
</tr>
</tbody></table>
<p><sup>i</sup>蒋家胡同村为设备识别号，小穿芳峪村为维修前后通道号</p>
<p>&nbsp;</p>
<p><strong>对象识别和重识别</strong> 本研究根据视频特点选择了两种基于深度学习（Deep Learning）的视频识别算法。A类点位以人为主，对重识别精确度要求较高，使用FairMOT(ZHANG等, 2020)算法。B类点位人车混合，处理的主要目的是流量统计，使用YOLOv5(JOCHER等, 2021) + Deep SORT算法(WOJKE等, 2017, 2018) 。均通过Python实现。图4.2简要介绍了算法识别和追踪的原理。环境配置和所参考的代码、使用的识别模型来源见附录B。本研究侧重于算法在村庄具体情境的应用，对具体原理、实现方法不详细展开。</p>
<p>识别过程首先是检测图像中对象的具体位置，得到一系列方框范围（图4.3）。其底边中点即是对象平面位置在图像中的位置。并且通过识别和重识别，得到每一个对象的ID作为记录的基准。</p>
<p>&nbsp;</p>
<center>

<p><img src="/2021/06/08/Wi-Fi-and-Video-Data/image026.jpg" alt></p>
<p>图4.2 本研究选用的视频识别算法原理简介</p>
<p>&nbsp;</p>
<p><img src="/2021/06/08/Wi-Fi-and-Video-Data/image027.jpg" alt></p>
<p>图4.3 FairMOT识别效果示例（小穿芳峪18）</p></center><p></p>
<p>&nbsp;</p>
<p><strong>删除无效数据</strong> 一些对象（如树叶，雕塑）等会被误识别为行人。通过绘制热力图可以发现这些异常点，在与原始视频数据对比后可以确认是无效数据。标记其坐标后删除所有该坐标附近的记录（此操作的前提是干扰对象可能不停获得新的ID，而其坐标附近行人无法到达）。 </p>
<p>&nbsp;</p>
<p><strong>初步标识</strong> 根据视频文件名获知每段监控视频开始的时间。根据每一帧的相对时间计算实际对应的时刻。根据过去3秒内该ID是否曾经出现，将每条记录标记为新出现的对象或是追踪中的对象（在对象连续运动的过程中，可能出现若干帧未被识别的情况，但之后仍然可能成功重识别）。</p>
<p>&nbsp;</p>
<p><strong>投影变换</strong> 不同的坐标体系间可通过解析变换法进行投影变换（Projection Transformation）(王汶, 2010)。如图4.4所示，在摄像头画面和平面上各提取四个特征点的坐标，计算变换矩阵（Transformation Matrix）。将摄像头画面内坐标（补充维数后）与变换矩阵相乘即可得到平面上坐标。</p>
<p>&nbsp;</p>
<center>

<p><img src="/2021/06/08/Wi-Fi-and-Video-Data/image028.jpg" alt></p>
<p>图4.4 投影变换示例（小穿芳峪18）</p></center><p></p>
<p>&nbsp;</p>
<p><strong>速度计算</strong> 投影变换后，可以进一步对追踪中的对象计算速度大小和方向。</p>
<p>&nbsp;</p>
<p>每个视频文件处理完毕后将数据按日期和摄像头通道合并到一个文件。至此，视频数据预处理完毕。</p>
<p>&nbsp;</p>
<h3 id="4-4-作为节点的视频数据分析"><a href="#4-4-作为节点的视频数据分析" class="headerlink" title="4.4 作为节点的视频数据分析"></a>4.4 作为节点的视频数据分析</h3><p><strong>单日流量变化</strong> 与Wi-Fi数据处理类似，记录一天之内摄像头捕捉到的不同对象。若以每一帧的对象个数直接作统计图，则无法按重识别结果去重得到实际人数，并且数据将过于零散。因此需要统计每个时间窗内不同ID对象总数作为实际人数。由于重识别受算法本身准确度、光线、遮挡等因素限制，成功率有限，可能使同一对象在连续出现时被多次分配不同ID。因此统计流量的时间窗不易过长。取2分钟作为时间窗长度，并进行宽度为24分钟的滑动均值滤波处理，绘制一天内流量变化（图4.5）。</p>
<p>&nbsp;</p>
<center>

<p><img src="/2021/06/08/Wi-Fi-and-Video-Data/image029.jpg" alt></p>
<p>图4.5 单日流量变化（视频）（蒋家胡同1、小穿芳峪18、19）</p></center><p></p>
<p>&nbsp;</p>
<p>单日流量变化图与视频截图相对照，充分体现了节点在不同日期吸引不同人群。蒋家胡同村大队前的广场在工作日时是村民们排长队的地方，在周末和假日则成为孩子们玩耍的操场。</p>
<p>小穿芳峪村的村广场和景区入口则体现出节假日和周末的区别。节假日的景区入口在上午和下午都有持续的流量，而村广场在中饭和晚饭时间则少有访客。此外，作为一个面积100平方米左右的小广场，高峰时间每两分钟有30余人访问，已颇具人气。</p>
<p>&nbsp;</p>
<p><strong>往来流量变化</strong> 受误识别、多ID等因素限制，单日流量变化图准确度有限。对于路口节点，可以进一步判断行人的往来方向，作为筛选依据，统计往来的流量变化。</p>
<p>以小穿芳峪村售票亭外路口为例，将视频画面划分为若干部分（图4.6）：路口内部和每个方向的部分。当对象从一个方向1进入路口，从另一个方向3离开后，即视为是从在此路口从1前往了3。可根据1→0→3的轨迹得到此判断。而若轨迹为1→0→2→0→3等，即取首尾即可。</p>
<p>&nbsp;</p>
<center>

<p><img src="/2021/06/08/Wi-Fi-and-Video-Data/image030.jpg" alt><br><img src="/2021/06/08/Wi-Fi-and-Video-Data/image031.jpg" alt></p>
<p>图4.6 路口视频画面划分（小穿芳峪19）</p></center><p></p>
<p>&nbsp;</p>
<p>在此基础上可以有效减少误识别的影响，分各个方向做出往来流量变化和累计图（图4.7）。有267人从大队部方向进入景区，这与村内路牌所指引的进入方向相符（而不是从主干道方向小路进入，共28人）。与根据多点位Wi-Fi数据所绘点位间流量变化进行比较。从大队部前往售票处的流量在视频数据结果（图4.7蓝色实线）与Wi-Fi数据结果访客机主部分（图4.8红色、绿色）趋势相似。流量峰值分别在上午9-10点，下午15-17点达到。</p>
<p>&nbsp;</p>
<center>

<p><img src="/2021/06/08/Wi-Fi-and-Video-Data/image032.jpg" alt><br><img src="/2021/06/08/Wi-Fi-and-Video-Data/image033.jpg" alt></p>
<p>图4.7 往来流量变化和累计（视频）（小穿芳峪19）</p>
<p>&nbsp;</p>
<p><img src="/2021/06/08/Wi-Fi-and-Video-Data/image034.jpg" alt></p>
<p>图4.8 点位间流量变化（Wi-Fi）（从小穿芳峪7往8）</p></center><p></p>
<p>&nbsp;</p>
<p>基于视频数据的往来流量变化精度更高，适合作为重要节点、日期的监测工具。而基于Wi-Fi数据的方法则更多反应一种整体规律，但必须依赖于完整AP网络。</p>
<p>接下来考察作为村庄边界的节点，它们反应了出入村庄的人流量。图4.9展示了蒋家胡同村5个村庄边界摄像头（涵盖了除了几个和邻村相连的小路口外所有的路口）在一个工作日7-19点内的情况。首先观察整体出入总数，村庄东北角的路口出入数显著小于其余节点。其余节点的出入数都在100上下。大小关系与根据质心计算所得结果相比较（图4.10，参见3.5节），说明：一些节点出入流量小，而总在线时长大，是聚集场所（东边的上学路口，这符合3.4节根据单日流量变化聚类的结论，也可能和东边西五百户村的中心集聚型村庄属性(北京清华同衡规划设计研究院有限公司, 2020)相关）；一些点位出入流量大，而总在线时长短，是交通路口，但没有聚集的活力（西北角路口，流量最大）。</p>
<p>&nbsp;</p>
<center>

<p><img src="/2021/06/08/Wi-Fi-and-Video-Data/image035.jpg" alt></p>
<p>图4.9 蒋家胡同村边界点位往来流量（视频）（7、8、9、10、11）</p>
<p>&nbsp;</p>
<p><img src="/2021/06/08/Wi-Fi-and-Video-Data/image036.jpg" alt></p>
<p>图4.10 蒋家胡同村Wi-Fi和视频所得边界点位流量对比</p></center><p></p>
<p>&nbsp;</p>
<p>观察出村人数和入村人数，出村数均略高于入村数。这是因为视频数据受只在日间能较好采集的局限，只截止到19点，许多出村工作者尚未回村。特例是西北角路口，流量最大的同时，入村数显著高于出村数。结合村庄西南方向有需要绕行的进京检查站这一场地条件，可以推出这一情况是由于邻村居民借过蒋家胡同村出行，最终从西南或东南角两个路口前往国道。（注：观察曲线可知入村曲线与出村曲线始终保持大致同步，以上数值中不少是短暂时间内出入者。但不影响上述结论。）</p>
<p>&nbsp;</p>
<h3 id="4-5-作为场所的视频数据分析"><a href="#4-5-作为场所的视频数据分析" class="headerlink" title="4.5 作为场所的视频数据分析"></a>4.5 作为场所的视频数据分析</h3><p>作为场所的视频数据，即是要研究以行人为主的对象如何使用该场所、进行了哪些具体行为。这更受到摄像精度和算法功能的限制。以小穿芳峪村的摄像头为例（图4.3），分辨率为1280*720像素，最近处行人高度约为230像素，头高40像素。在这一尺度上难以对面部特征进行有效提取，更多依赖动态、姿势以作进一步分析。本研究受技术和时间所限，仅以对象位置和移动过程为图像提取结果。</p>
<p>遗憾的是，蒋家胡同村的村广场并无摄像头，以下主要以小穿芳峪村村广场为例：</p>
<p>&nbsp;</p>
<p><strong>热力</strong> 热力图可以总结场所内各部分的人气。如图4.11，在五一假期，不少游客在“和谐”大石头前合影留念，也有村民在此处售卖农产品。而玩耍的孩子们多围绕人型雕塑和可踩踏的低矮围挡。（注：由于“打点”是按固定时间间隔进行的，图像上近大远小的透视效果会导致远处更密集，在热力图上颜色更深。因此此热力图在平面上更准确。）</p>
<p>&nbsp;</p>
<center>

<p><img src="/2021/06/08/Wi-Fi-and-Video-Data/image037.jpg" alt><br><img src="/2021/06/08/Wi-Fi-and-Video-Data/image038.jpg" alt></p>
<p>图4.11 5月2日图像和平面热力图（视频）（小穿芳峪18）</p></center><p></p>
<p>&nbsp;</p>
<p><strong>轨迹</strong> 轨迹图可以在数据量不过多的情况下进一步地展示场地使用情况（图4.12）。可以看到花坛左侧的围挡被孩子们跨越。花坛和围挡等高度在30厘米上下的景观构件都被往来的孩子们当作是小路充分利用。孩子们也喜欢跳到大石头上下。</p>
<p>&nbsp;</p>
<center>

<p><img src="/2021/06/08/Wi-Fi-and-Video-Data/image039.jpg" alt><br><img src="/2021/06/08/Wi-Fi-and-Video-Data/image040.jpg" alt></p>
<p>图4.12 5月2日图像和平面轨迹图（视频）（小穿芳峪18）</p></center><p></p>
<p>&nbsp;</p>
<p>虽然通过投影变换能绘制更直观、合理的点位特征图像，这也反映了摄像头只能捕捉一个视角范围的局限。因此图4.11和4.12的平面图像更像是一个三角形内的一部分，而且还受到树木的遮挡。</p>
<p>&nbsp;</p>
<p>道路节点的轨迹图则能反应各路口和各种路面材料的使用情况（图4.13）。例如，蒋家胡同村无论是行人还是车辆都更青睐于水泥路面而非砖石路面。村庄中没有闹市的围栏、信号牌。人们走的样子就成了路的样子。这是轨迹图所向我们佐证的。可以预见此方法运用于多山地区有高差的路口、公共空间时可以获得更多发现。</p>
<p>&nbsp;</p>
<center>

<p><img src="/2021/06/08/Wi-Fi-and-Video-Data/image041.jpg" alt></p>
<p>图4.13 道路轨迹示意（视频）（蒋家胡同8、9、10、小穿芳峪3）</p></center><p></p>
<p>&nbsp;</p>
<p><strong>速度分布</strong> 根据齐大勇(2019)基于视频数据的校园交通研究，可以将行人根据平均速度分为三类：小于每秒0.6 米的几乎是静止的行人；每秒0.6到 1.4 米的步行的行人；大于每秒1.4米的骑自行车和电动车的行人或汽车。本文的绘制逻辑是根据各时刻的速度绘制速度分布热力图，而非统计整条轨迹的平均速度。</p>
<p>图4.14是小穿芳峪村广场和蒋家胡同村上学路口的对比。村广场在“和谐”大石头前有驻足拍照的游客和售卖的村民（左上）。而村广场内也有不少孩子奔跑打闹（右上）。蒋家胡同村上学路口则基本无停留的村民（左下）。骑行或驾车的村民的路径更为集中在道路中线（右下），而步行的村民则更分散（中下）。与之前此处为聚集路口的结论相比，说明聚集的位置在镜头之外，参考地图，可能是路口南边。</p>
<p>由于近大远小的透视关系，镜头远处的系统误差在计算速度时被放大了，使得速度比实际值显著要高。如小穿芳峪村广场西边的高速度区域（右上），实际是施工中的工人，速度应当归于步行范围。</p>
<p>&nbsp;</p>
<center>

<p><img src="/2021/06/08/Wi-Fi-and-Video-Data/image042.jpg" alt></p>
<p>图4.14 速度分布平面图（视频）（小穿芳峪18、蒋家胡同9）</p></center><p></p>
<p>&nbsp;</p>
<p><strong>聚集</strong> 除了简单相叠加的流量和轨迹，视频数据可以用于初步探寻人与人的互动情况。人群如何聚集即是其中之一。此处使用了DBSCAN（Density-Based Spatial Clustering of Applications with Noise，基于密度的有噪空间聚类）算法判断人群聚集。DBSCAN算法是适用于空间内散布的对象的聚类方法。它根据相近的点的距离和数目，识别出若干具有一定密度的区域，将其划分为“簇”，其余划为噪声（Noise）。此处参数设置为半径1米，领域最小点数3。</p>
<p>对于每一帧各个对象在平面上的位置进行DBSCAN聚类。图4.15即是实际处理时的示例。对象被识别为两簇聚集的人：0标记有4人，1标记有3人。其余-1标记即DBSCAN中的噪声（Noise），不属于任何聚集的单独的人。</p>
<p>对比每个时间窗形成的最大聚集规模（图4.16），工作日的上午，村广场不形成聚集，说明使用率低，或是使用者为独自或两人。节假日上午有大量人流造访村广场。除此之外村广场没有形成4人以上规模的聚集。</p>
<p>&nbsp;</p>
<center>

<p><img src="/2021/06/08/Wi-Fi-and-Video-Data/image043.jpg" alt></p>
<p>图4.15 DBSCAN聚类结果示例（小穿芳峪18）</p>
<p>&nbsp;</p>
<p><img src="/2021/06/08/Wi-Fi-and-Video-Data/image044.jpg" alt></p>
<p>图4.16 单日聚集规模变化（视频）（小穿芳峪18）</p></center><p></p>
<p>&nbsp;</p>
<p>将每一簇聚集者的坐标取平均值，可以记为聚集形成的位置。画出各日期聚集形成的位置热力（图4.17），可以进一步对比其使用特点。节假日的游客多聚集在雕塑和大石头处打卡拍照，而周末的孩子们在空地上聚集得更多。工作日施工的工人们也被如实记录。村广场虽然面积较小，已然成为不同人群共享的村庄重要公共空间。其利用情况是值得肯定的。</p>
<p>&nbsp;</p>
<center> 

<p><img src="/2021/06/08/Wi-Fi-and-Video-Data/image045.jpg" alt></p>
<p>图4.17 聚集热力图（视频）（小穿芳峪18）</p></center><p></p>
<p>&nbsp;</p>
<h3 id="4-6-本章小结"><a href="#4-6-本章小结" class="headerlink" title="4.6 本章小结"></a>4.6 本章小结</h3><p>本章采用的基于视频识别、追踪的方法具有精确性高、可视化能力强的特点。通过作为节点和场所的数据分析，可以精确地统计村民出行情况，也可以对重要节点的使用模式加以剖析。在更完整的网络铺设下，视频和Wi-Fi的分析结果也可以作更多对比验证。</p>
<p>作为一个应用方法验证的研究，本章提供了基于视频数据的一个村庄监测与研究的框架。更全面的视频数据处理分析应当包括实时的识别和追踪，实时重要变化的监测。这意味着摄像头和分析程序的结合。但视频数据涉及隐私，开发专用软件和硬件（实时分析的摄像头），并应用于此类空间研究应该受到更严格的限制。</p>
<p>&nbsp;</p>
<p>具体在本研究所涉及的两个村子上，基于视频识别的数据分析推导出了如下结论：</p>
<p>村民们早出晚归，大部分边界道路节点都得到了充分利用，视频识别能精准记录进出人数，与Wi-Fi数据得到的趋势相符。也可以记录行人和车辆的速度、轨迹，以考察道路面的使用情况。</p>
<p>不同日期，重要公共空间的使用情况也发生变化。小穿芳峪村广场在节假日吸引拍照打卡的游客聚集，在周末则更多被孩子们所占领。蒋家胡同村大队前广场在不集中办理手续时，也被孩子们当作操场玩耍。</p>
<p>对于场地空间变化丰富的小穿芳峪村广场，视频识别能判断其热力点，以及在何时何地形成聚集，进而发挥其社会场所的功能。这是对场所公共性的评估，小穿芳峪村广场小而精，给我们留下了深刻印象。</p>
<p>&nbsp;</p>
<p>值得注意的是视频数据处理依赖于高性能计算机设备，不及Wi-Fi方法易于大规模铺展开来。也因此，视频数据作为治安管理的重要工具，目前应用主要限于城市的重要节点。环境行为学所能更好利用的视频比监控摄像头有更专业的要求。其布设亦可更有针对性，不局限于具有治安意义的村庄边界路口。正如第一章所言，技术更新已然成熟，社会学家和设计师们都应当更主动加以利用。</p>
<p>&nbsp;
 </p>
<h2 id="第5章-结论"><a href="#第5章-结论" class="headerlink" title="第5章 结论"></a>第5章 结论</h2><h3 id="5-1-技术应用展望"><a href="#5-1-技术应用展望" class="headerlink" title="5.1 技术应用展望"></a>5.1 技术应用展望</h3><p>前两章已对本研究应用的Wi-Fi定位和视频识别技术及分析结果做出总结。以下将根据研究框架（图2.5）分“采集”、“处理”、“分析”三方面综合两种技术进行讨论。</p>
<p>&nbsp;</p>
<p><strong>采集</strong> 相对大尺度的村域、乡域空间，基于原点小区（COO）的Wi-Fi定位可以以较低的铺设成本和维护成本实现机主移动的动态监测。但随着更多手机品牌主动使用随机MAC地址规避追踪，本方法采集缺失率会增加。</p>
<p>村庄的监控视频设备由村委统一管理，用于后续处理的视频数据需要最小化丢失时间段，因此需要选择更稳定的产品和数据传输方式。视频数据受视角范围和遮挡物双重限制，尽管精确性较高，难以高效捕捉大面积空间，适合于重要节点采用。</p>
<p>视频识别技术直观、具体但受限的特点，和Wi-Fi定位技术的特点是互补的。在研究伦理所允许的范围内，两种设备也可以相结合（共同布置或开发两者合一的即时处理的设备）。例如，将所捕捉的Wi-Fi信号强度和视频图像两两种或数据所识别的行人进行对应。</p>
<p>&nbsp;</p>
<p><strong>处理</strong> 无论是Wi-Fi还是视频数据，其从原始数据到生产数据框的过程都涉及具体算法的选择。在设备不变的情况下，可以选择多模型协作的算法，提高重点节点的定位和识别精度。</p>
<p>例如在室外广场布置更密集的AP，采用与室内类似的方法（如指纹算法）处理Wi-Fi数据进行定位。作为大致定位的补充。</p>
<p>视频数据则可在识别对象较清晰时加入体态、表情等识别模型，进而提取事件信息。</p>
<p>&nbsp;</p>
<p><strong>分析</strong> 作为环境行为学的最后一个环节，基于数据的分析过程也可以逐步实现技术上的革新。本文对节点进行的机器学习聚类即是一个例子。行人、车辆的识别与追踪形成的数据框，与建筑学、规划学所关注的具有物理意义的指标如何相对接，仍然有待思路的拓宽。在更成熟的数据处理框架下，Wi-Fi和视频数据能够作为地理信息系统（Geographic Information System, GIS）的输入值，成为多图层协作的人居环境研究的一个有机组成部分。</p>
<p>&nbsp;</p>
<h3 id="5-2-农村空间行为时空特征"><a href="#5-2-农村空间行为时空特征" class="headerlink" title="5.2 农村空间行为时空特征"></a>5.2 农村空间行为时空特征</h3><p>本研究在时间和空间上对两村村民的空间行为展开了考察。</p>
<p>时间上，既包括四个多月来的整体变化，也包括一天之内的特征，不同日期的对比。空间上，既有整村的统计，也有节点间的联系，节点作为场所的分析。</p>
<p>以Wi-Fi和视频技术主导的本研究，以无预设、无选择性地分析呈现作为一切结论的前提。因此本研究积极使用了作图表达作为媒介，并采用了多种机器学习算法。像前文所展示的那样，一些结论是通过对同一处使用不同数据、不同分析方法综合取舍才得出的。</p>
<p>&nbsp;</p>
<p>对于两村村民的空间行为时空特征，可以做以下概扩总结：</p>
<p>我们的研究没有直面农业，无从了解村庄中以年长者为主的一部分务农村民如何规划它们的一天。而对于其余的不少村民，我们观察到：劳务输出村和网红旅游村的属性使得他们也像流行语中的“打工人”一样，过着早出晚归的生活。在小穿芳峪村，当旅游旺季来临，村民们也动员起来投入到准备工作和服务之中。</p>
<p>在工作日、周末和节假日，村庄节点的功能也在发生改变，村庄作为一个整体在生产、休闲、动员等各种模式之间切换自如。</p>
<p>两村的公共休闲设施尽管简朴，却发挥了不少的作用。Wi-Fi数据告诉我们蒋家胡同村的球场和广场是邻村人周末傍晚的目的地。视频数据告诉我们小穿芳峪村的小广场尽管小，却是游客喜爱的打卡地，孩子们洒脱的地方。</p>
<p>村庄路口亦呈现出区别，人的行动受交通组织主导，进而影响全村甚至邻村的活力。在研究范围更广阔时，能体现出更多村际网络特征。</p>
<p>&nbsp;</p>
<h3 id="5-3-农村人居环境与治理术"><a href="#5-3-农村人居环境与治理术" class="headerlink" title="5.3 农村人居环境与治理术"></a>5.3 农村人居环境与治理术</h3><p><em>“城市是石头的、理性的、计算的、消费的、陌生的、分解的、契约的、交换价值的。</em></p>
<p><em>“乡村是泥土的、情感的、含混的、生产的、熟悉的、整体的、血缘的、使用价值的。”</em> (张柠, 2013)</p>
<p>无论是我所接受的建筑学训练还是社会学训练，学者们总是将更多关注给予城市。仿佛城市是人类一切聚居形式的代言。本研究所使用的技术，在城市的各个维度都得到过应用。但农村很少像这样被放在技术的显微镜下。</p>
<p>当我们将技术应用其中，却发现结论的得出并不困难。</p>
<p>2015年以来，环京地区和北京的人口密度落差正在收窄(国务院发展研究中心宏观经济研究部等, 2019)。京津冀协同发展战略、北京市战略东移的背景下，我们的考察对象已不是完全传统的泥土的农村。</p>
<p>蒋家胡同村和小穿芳峪村同样是理性的。但它们保有着的社会关系使外人首先看到的并非其背后的价值与算计。本研究展示的两个村庄，在各具特色的同时，共同体现了作为社区的现代性。村民们对生计有着主动的选择，对于祖先的、宗法的遗留传统则精简之。</p>
<p>&nbsp;</p>
<p>我们的案例符合这样的结论：农田之内的，建设用地所承载的农村，已然成为了一种由基层组织所管辖的社区。基层组织建设、整体规划背景下的农村产业扶持，等等这些政策，创造了一种农村向城市的过渡形态。而我们认为这种形态缺乏相对应的现代的治理术（governmentality）(福柯, 2018)。此处我们并不强调其作为统治权的国家治理，而是强调其对“人口”，这一需要的、欲望的主体的治理。这一在统计数据中被高度抽象化、难以凑近观察的主体的治理。</p>
<p>&nbsp;</p>
<p>治理的科学是研究财富与人口之间关系的科学(福柯, 2018)。建筑学视角下，人口是人居环境的服务对象，是安居——生产机制的选择者和实行者。不仅仅是垃圾整治、公厕改造、路面提升这些物理环境的改造，聚焦于公共空间形态与功能的农村人居环境考察应当在治理术中占据更重要的地位。尤其是村庄中重要公共场所，需要承担更重要的角色，Gieling等(2019)发现在荷兰，以超市、咖啡馆为代表的村庄设施对村民们的归属感有着重要作用。我们的研究对象，京津冀城市群中的华北普通村落，没有咖啡馆这样的高消费场所，但也具有人口密度、建筑密度高的特点。村民们对村庄公共空间的利用体现了这样一种归属感和地点依恋（Space Attachment）。在城市化进程下，优质的人居环境所孕育的这种依恋，及其衍生的社会功能，对于人口的治理尤为重要。</p>
<p>我们认为环境行为学方法形成的空间行为数据、它对人居环境重要意义的佐证，作为治理术的文件依据的一部分，能够体现珍贵的“对社会生活中具体情理的关注”和“对世界丰富与深邃的时空想象”(杜月, 2017)。扎根于泥土的科学研究，能够优化现代治理术理念下对资源的调节配置，使所有人更受益于村庄优质的人居环境，这是我们共同的愿景。 </p>
<p>&nbsp;</p>
<h2 id="参考文献"><a href="#参考文献" class="headerlink" title="参考文献"></a>参考文献</h2><pre>
北京清华同衡规划设计研究院有限公司, 2020. 天津市蓟州区村庄布局专项规划阶段成果汇报[Z](2020).

曾婷, 黄东军, 2021. 智能视频监控系统异常行为检测算法研究综述[J]. 计算机测量与控制, : 1–9.

传化慈善基金会公益研究院“中国卡车司机调研课题组”, 2018. 中国卡车司机调查报告No.1[M]. 北京: 社会科学文献出版社.

杜月, 2017. 制图术:国家治理研究的一个新视角[J]. 社会学研究, 32(05). DOI:10.19934/j.cnki.shxyj.2017.05.009.

福柯, 2018. 安全、领土与人口[M/OL]. 钱翰, 陈晓径, 译. 上海人民出版社[2021–06–06]. https://book.douban.com/subject/30354859/.

国务院发展研究中心宏观经济研究部, 国务院发展研究中心宏观决策支持大数据实验室, 2019. 迁徙的人 变动的城：大数据视角下的中国城镇化[M]. 北京: 中国发展出版社.

蒋晓峰, 2013. 基于视频图像处理的公交车人流量统计系统的研究[D]. 华南理工大学.

李道增, 1999. 环境行为学概论[M]. 北京: 清华大学出版社.

梁英宏, 王知衍, 曹晓叶, 等, 2008. 视频图像理解在客流统计中的应用[J]. 计算机工程与设计, (05): 1203–1206.

齐大勇, 2019. 基于视频图像数据的环境行为研究方法初探[D]. 北京: 中国科学院大学.

汤义, 2010. 智能交通系统中基于视频的行人检测与跟踪方法的研究[D]. 华南理工大学.

王汶, 2010. 地理信息系统在社会科学中的应用[M]. 北京: 中国社会出版社.

温铁军, 2016. 乡村建设的中国道路[M]//人間思想 第四輯. 台北: 人间出版社.

文贯中, 2014. 吾民无地：城市化、土地制度与户籍制度的内在逻辑[M]. 上海: 东方出版社.

沃斯路易斯, 2007. 作为一种生活方式的都市生活[J]. 都市文化研究, 2007(1).

吴良镛, 1989. 广义建筑学[M]. 北京: 清华大学出版社.

武亚军, 2015. 视频图像侦查在公安工作中的发展和应用[D]. 西北大学.

张诚, 刘祖云, 2019. 乡村公共空间的公共性困境及其重塑[J]. 华中农业大学学报(社会科学版), 2019(2).

张柠, 2013. 土地的黄昏：中国乡村经验的微观权力分析（修订版）[M]. 北京: 中国人民大学出版社.

中共中央办公厅, 国务院办公厅, 2018. 农村人居环境整治三年行动方案[EB/OL](2018). http://www.gov.cn/zhengce/2018-02/05/content_5264056.htm.

中国共产党第十九届中央委员会, 2020. 中共中央关于制定国民经济和社会发展第十四个五年规划和二〇三五年远景目标的建议[EB/OL](2020). http://news.cnr.cn/native/gd/20201103/t20201103_525318585.shtml.

周其仁, 2017. 城乡中国（修订版）[M]. 北京: 中信出版集团.

周雪光, 2017. 中国国家治理的制度逻辑[M]. 北京: 生活·读书·新知三联书店.

BAI Y B, WU S, REN Y, 等, 2014. A New Approach for Indoor Customer Tracking Based on a Single Wi-Fi Connection[M]//2014 International Conference on Indoor Positioning and Indoor Navigation (IPIN). New York: IEEE: 239–245.

CISCO DNA CENTER, 2020. Cisco DNA Center Q&A for Randomized MAC Addresses[Z/OL](2020–10–05)[2021–05–27]. https://www.cisco.com/c/dam/en/us/td/docs/cloud-systems-management/network-automation-and-management/dna-center/tech_notes/Cisco_DNA_Center_Randomized_MAC_QA.pdf.

GIELING J, HAARTSEN T, VERMEIJ L, 2019. Village Facilities and Social Place Attachment in the Rural Netherlands[J]. Rural Sociology, 84(1): 66–92. DOI:https://doi.org/10.1111/ruso.12213.

HE S, CHAN S-H G, 2016. Wi-Fi Fingerprint-Based Indoor Positioning: Recent Advances and Comparisons[J]. IEEE Communications Surveys and Tutorials, 18(1): 466–490. DOI:10.1109/COMST.2015.2464084.

IEEE COMPUTER SOCIETY, 2016. IEEE Standard for Information technology—Telecommunications and information exchange between systems Local and metropolitan area networks—Specific requirements - Part 11: Wireless LAN Medium Access Control (MAC) and Physical Layer (PHY) Specifications[J]. IEEE Std 802.11-2016 (Revision of IEEE Std 802.11-2012). DOI:10.1109/IEEESTD.2016.7786995.

JOCHER G, STOKEN A, BOROVEC J, 等, 2021. ultralytics/yolov5: v5.0 - YOLOv5-P6 1280 models, AWS, Supervise.ly and YouTube integrations[M/OL]. Zenodo[2021–06–02]. https://zenodo.org/record/4679653. DOI:10.5281/zenodo.4679653.

LYNCH K, 1960. The Image of the City[M]. The MIT Press.

MATTE C, CUNCHE M, ROUSSEAU F, 等, 2016. Defeating MAC Address Randomization Through Timing Attacks[C]//Proceedings of the 9th ACM Conference on Security & Privacy in Wireless and Mobile Networks. Darmstadt Germany: ACM: 15–20. DOI:10.1145/2939918.2939930.

OKABE A, SUZUKI A, 1997. Locational Optimization Problems Solved through Voronoi Diagrams[J]. European Journal of Operational Research, 98(3): 445–456. DOI:10.1016/S0377-2217(97)80001-X.

PARK K, 2020. Park and Neighborhood Attributes Associated With Park Use: An Observational Study Using Unmanned Aerial Vehicles[J]. Environment and Behavior, 52(5): 518–543. DOI:10.1177/0013916518811418.

STEWART O T, VERNEZ MOUDON A, SAELENS B E, 等, 2016. Comparing Associations Between the Built Environment and Walking in Rural Small Towns and a Large Metropolitan Area[J]. Environment and Behavior, 48(1): 13–36. DOI:10.1177/0013916515612253.

WOJKE N, BEWLEY A, 2018. Deep Cosine Metric Learning for Person Re-identification[C]//2018 IEEE Winter Conference on Applications of Computer Vision (WACV). IEEE: 748–756. DOI:10.1109/WACV.2018.00087.

WOJKE N, BEWLEY A, PAULUS D, 2017. Simple Online and Realtime Tracking with a Deep Association Metric[C]//2017 IEEE International Conference on Image Processing (ICIP). IEEE: 3645–3649. DOI:10.1109/ICIP.2017.8296962.

ZHANG Y, WANG C, WANG X, 等, 2020. FairMOT: On the Fairness of Detection and Re-Identification in Multiple Object Tracking[J]. ArXiv:2004.01888 [Cs].

ZHOU X, LI D, LARSEN L, 2016. Using Web-Based Participatory Mapping to Investigate Children’s Perceptions and the Spatial Distribution of Outdoor Play Places[J]. Environment and Behavior, 48(7): 859–884. DOI:10.1177/0013916515571732.
</pre>

<p>&nbsp; </p>
<h2 id="致谢"><a href="#致谢" class="headerlink" title="致谢"></a>致谢</h2><p>感谢黄蔚欣老师在学术上的指点。在工作室学习、设计和研究期间，黄老师给予的帮助和鼓励使我建立了对于科研的严谨态度和钻研精神。也使我坚定了在将来学习生活中不断自主思考、突破边界的信念。</p>
<p>感谢熊鑫昌助教在技术实现上的指导。在建筑学院能一起通过技术学习对我们所处的人居环境建立理性认识，是何其幸运。</p>
<p>感谢室友们在五年来的鼓励。你们是我的避风港湾，也是我的起飞跑道。希望毕业后我们都能将这份浓浓的爱传递给更多的人。</p>
<p>感谢两村村干部的热情招待，使本研究成为可能。更重要的是，感谢所有像他们一样的基层干部，所有将自身奉献于乡村振兴的伟大事业之中的人。</p>
<p>本研究承蒙“十三五”国家重点研发计划“绿色宜居村镇创新”重点专项“村镇聚落空间重构数字化模拟及评价模型”项目课题三“村镇聚落发展评价模型与变化监测”子课题三“村镇聚落经济社会活动数据提取与监测评价”（项目编号：2018YFD100303-06/08/09）资助，特此致谢。</p>
<p>本研究运用了国家自然科学基金面上项目“基于大数据分析的建筑室内外公共空间环境行为模式研究”（项目编号：51578299）和“基于数据分析的建筑策划方法体系更新研究”（项目编号：51778315）的成果，特此致谢。</p>
<p>2021年6月8日</p>
<p>&nbsp;</p>
<h2 id="附录"><a href="#附录" class="headerlink" title="附录"></a>附录</h2><h3 id="时间窗处理算法"><a href="#时间窗处理算法" class="headerlink" title="时间窗处理算法"></a>时间窗处理算法</h3><p>（决定每个时间窗移动设备唯一的配对AP）</p>
<p><strong>Overkill：在时间窗压缩之前，先初步清洗数据</strong></p>
<p>我们用大写字母表示移动设备与某一AP进行握手。在移动设备保持不动的同时，每5秒钟AP将记录一次握手。</p>
<p>例如：A A A A B B B B B B B B C C C C C C C</p>
<p>这表示移动设备从A到B再到C</p>
<p>因此在overkill这一步，可以将连续的打点只取头尾两处，即将与上一条记录和下一条记录设备和AP均相同的（记为x）且间隔均<br>不大于5秒的（记为~y）剔除</p>
<p>如此得到的预处理数据会变为 A … A B … B C … C</p>
<p>但中间省去不变的数据（确定该移动设备保持不动）和此时段未记录到数据（该移动设备WiFi关闭）的意义并不相同</p>
<p>因此每个时间窗至少保留前5秒的数据，要剔除的数据还得满足不处在前5秒（记为z）</p>
<p>因此剔除x &amp; (<del>y) &amp; (</del>z)的数据，即保留(~x) | y | z的数据</p>
<p>&nbsp;</p>
<p><strong>Time Window Compress：时间窗压缩</strong></p>
<p>先对当前时间窗取AP众值（mode）</p>
<p>参考在overkill的做法，如果移动设备同时与多个AP持续握手，则因为握手交替被记录，不会被overkill</p>
<p>如果在时间窗内一小段时间“被干扰”（即与第二个AP握手），则 overkill情况如下，此时取众值仍然是合理的</p>
<p>[ A A A A A A A B A B A B A B A A A ] → [ A … A B A B A B A B A …]（众值为A）</p>
<p>如果在前5秒内“被干扰”，则可能会存在多个众值</p>
<p>[ A B A B A B A B A A A ] → [ A B A B A B A B A …]（众值为 A）</p>
<p>或[ B A B A B A B A A A ] → [ B A B A B A B A …]（众值为A 和B）</p>
<p>如果有多个众值，则不看众值，改为取该时间窗内信号强度（RSSI）最大值</p>
<p>如果该时间窗内信号强度（RSSI）最大值在多个AP记录到，则取第一个最大值</p>
<p>&nbsp;</p>
<h3 id="视频识别环境配置"><a href="#视频识别环境配置" class="headerlink" title="视频识别环境配置"></a>视频识别环境配置</h3><p><strong>Yolov5 + Deepsort环境配置（Windows10）</strong></p>
<p>源码链接：<a target="_blank" rel="noopener" href="https://github.com/dyh/unbox_yolov5_deepsort_counting">https://github.com/dyh/unbox_yolov5_deepsort_counting</a></p>
<p>参考项目视频：<a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV1jz411v7J7/">https://www.bilibili.com/video/BV1jz411v7J7/</a></p>
<p><em>主环境</em></p>
<p>新建环境（用PyCharm或Anaconda Prompt）</p>
<p>安装Nvidia官网下载的CUDA：<a target="_blank" rel="noopener" href="https://developer.nvidia.com/cuda-downloads">https://developer.nvidia.com/cuda-downloads</a></p>
<p>CUDA安装参考视频：<a target="_blank" rel="noopener" href="https://www.bilibili.com/video/BV18K411w7Vs">https://www.bilibili.com/video/BV18K411w7Vs</a></p>
<p>根据PyTorch官网<a target="_blank" rel="noopener" href="https://pytorch.org/">https://pytorch.org/</a> 给的pip3命令（别用conda）在Anaconda Prompt里安装PyTorch</p>
<p>在PyCharm里一键安装requirements.txt（PyCharm用的是conda命令）</p>
<p>在Anaconda Prompt里pip3安装剩下没成功的requirements</p>
<p><em>运行时的问题</em></p>
<p>（torch问题）运行时的bug：OMP: Error #15: Initializing libiomp5md.dll, but found libiomp5md.dll already initialized.</p>
<p>anaconda的环境下存在两个libiomp5md.dll文件，保留torch路径下的，删除（备份）虚拟环境本身路径下的</p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/Victor_X/article/details/110082033">https://blog.csdn.net/Victor_X/article/details/110082033</a></p>
<p>main和tracker.update中原代码使用类似于if len(bbox_list) &gt; 0:的判断语句。我修改为if bbox_list is not None:会产生错误，最后使用if bbox_list:无错误</p>
<p>&nbsp;</p>
<p><strong>FairMOT环境配置（Windows10）</strong></p>
<p>源码链接：<a target="_blank" rel="noopener" href="https://github.com/ifzhang/FairMOT">https://github.com/ifzhang/FairMOT</a></p>
<p><em>主环境</em></p>
<p>先装VC++：</p>
<p>直接装个Visual Studio 17会比较好，更新的版本会不行。官网下载不太行，可使用百度网盘<a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/33981517">https://zhuanlan.zhihu.com/p/33981517</a> 并且在里面安装以下包：</p>
<p>工作负载→使用C++的桌面开发</p>
<p>单个组件→VC++ 2017</p>
<p>新建环境（用PyCharm或Anaconda Prompt）</p>
<p>安装Nvidia官网下载的CUDA <a target="_blank" rel="noopener" href="https://developer.nvidia.com/cuda-downloads">https://developer.nvidia.com/cuda-downloads</a> （在试图安装之后的过程中从11.2切到了11.1）</p>
<p>根据PyTorch官网<a target="_blank" rel="noopener" href="https://pytorch.org">https://pytorch.org</a> 给的pip3命令（别用conda）在Anaconda Prompt里安装PyTorch </p>
<p>codepip3 install torch==1.8.1+cu111 torchvision==0.9.1+cu111 torchaudio===0.8.1 -f <a target="_blank" rel="noopener" href="https://download.pytorch.org/whl/torch_stable.html">https://download.pytorch.org/whl/torch_stable.html</a></p>
<p>在PyCharm里一键安装requirements（PyCharm用的是conda命令）</p>
<p>在Anaconda Prompt里pip3安装剩下没成功的requirements</p>
<p>安装cython-bbox仍然报错，解决办法：<a target="_blank" rel="noopener" href="https://www.jianshu.com/p/51f7f7f8b262">https://www.jianshu.com/p/51f7f7f8b262</a></p>
<p>在<a target="_blank" rel="noopener" href="https://pypi.org/project/cython-bbox/#files">https://pypi.org/project/cython-bbox/#files</a> 下载cython-bbox源文件</p>
<p>解压后将setup.py第31行extra_compile_args=[’-Wno-cpp’]替换为extra_compile_args={‘gcc’: [‘/Qstd=c99’]}</p>
<p>在Anaconda Prompt里cd至该文件夹后执行python setup.py build_ext install安装</p>
<p>再次尝试在Anaconda Prompt里pip3安装requirements，应当全部安装</p>
<p>ffmpeg.exe下载后存到src文件夹（并没有使用ffmpeg功能）</p>
<p><em>DCNv2</em></p>
<p>原理：<a target="_blank" rel="noopener" href="https://blog.csdn.net/justsolow/article/details/105971437">https://blog.csdn.net/justsolow/article/details/105971437</a></p>
<p>为了下一步做准备，直接跑会报cl找不到的错：</p>
<p>修改decode语言<a target="_blank" rel="noopener" href="https://codeleading.com/article/22062142947/">https://codeleading.com/article/22062142947/</a></p>
<p>添加环境变量</p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/discoverer100/article/details/101626615">https://blog.csdn.net/discoverer100/article/details/101626615</a></p>
<p>先尝试使用更新过兼容性的<a target="_blank" rel="noopener" href="https://github.com/MatthewHowe/DCNv2">https://github.com/MatthewHowe/DCNv2</a> 失败，改用第二位做的<a target="_blank" rel="noopener" href="https://github.com/rathaROG/DCNv2_Windows">https://github.com/rathaROG/DCNv2_Windows</a> 终于成功（不要安装ninja，不要在PyCharm Terminal里跑，用Anaconda Prompt跑），放在主项目src\lib\models\networks\下</p>
<p><em>运行时的问题</em></p>
<p>运行报错404网络问题，这是因为src\lib\models\networks\pose_dla_dcn.py的get_model_url使用的os.path.join()对Windows直接生成网址不适用（在Linux/macOS下会以斜杠（/）分隔路径，而在Windows下则会以反斜杠（\）分隔路径），替换为：return ‘<a target="_blank" rel="noopener" href="http://dl.yf.io/dla/models&#39;">http://dl.yf.io/dla/models&#39;</a> + ‘/‘ + data + ‘/‘ + ‘{}-{}.pth’.format(name, hash)</p>
<p>（和Yolov5+Deepsort同样的torch问题）运行时的bug：OMP: Error #15: Initializing libiomp5md.dll, but found libiomp5md.dll already initialized. </p>
<p>anaconda的环境下存在两个libiomp5md.dll文件，保留torch路径下的，删除（备份）虚拟环境本身路径下的</p>
<p><a target="_blank" rel="noopener" href="https://blog.csdn.net/Victor_X/article/details/110082033">https://blog.csdn.net/Victor_X/article/details/110082033</a></p>
<p>对于本身帧率信息缺失的视频，在src/lib/datasets/dataset/jde.py里需要math.isinf(self.cap.get(cv2.CAP_PROP_FPS))判断并手动添加信息，否则报错</p>
<p>&nbsp;</p>
<p><strong>备注</strong></p>
<p>以上一些步骤可能非必须的。使用的识别模型均为预训练的默认模型。硬件型号和软件版本：</p>
<p><em>Yolov5 + Deepsort</em></p>
<p>R7 1700 Windows 10 + conda 4.5.11 + Python 3.8.8</p>
<p>GTX 1060 6GB 461.33 + CUDA 11.2</p>
<p>torch 1.8.1+cu111</p>
<p><em>FairMOT</em></p>
<p>i7-10875H Windows 10 + conda 4.5.11 + Python 3.8.8</p>
<p>RTX 2070MQ 8GB 462.31 + CUDA 11.1</p>
<p>torch 1.8.1+cu111</p>

            </div>
          

    
      <footer class="post-footer">
		


		<div class="post-tags">
		  
			<a href="/tags/%E5%9F%8E%E5%B8%82%E7%A0%94%E7%A9%B6/">城市研究</a>
		  
			<a href="/tags/%E5%BB%BA%E7%AD%91%E5%AD%A6/">建筑学</a>
		  
			<a href="/tags/%E8%AE%BA%E6%96%87/">论文</a>
		  
		</div>
		

        
        
  <nav class="post-nav">
    
      <a class="prev" href="/2021/07/24/20210724/">
        <i class="iconfont icon-left"></i>
        <span class="prev-text nav-default">书架标签制作记录</span>
        <span class="prev-text nav-mobile">Prev</span>
      </a>
    
    
      <a class="next" href="/2021/02/28/La-phonetique/">
        <span class="next-text nav-default">La phonétique</span>
        <span class="prev-text nav-mobile">Next</span>
        <i class="iconfont icon-right"></i>
      </a>
    
  </nav>

        
  <div class="comments" id="comments">
    
    <div style="text-align:center;">
        <button class="btn" id="load-disqus" onclick="disqus.load();">加载 Disqus 评论</button>
    </div>
      <div id="disqus_thread">
        <noscript>
          Please enable JavaScript to view the
          <a target="_blank" rel="noopener" href="//disqus.com/?ref_noscript">comments powered by Disqus.</a>
        </noscript>
      </div>
    
  </div>


      </footer>
    
  </article>

    </div>

      </div>

      <footer id="colophon"><span class="copyright-year">
    
        &copy;
    
        2016 -
    
    2023
    <span class="footer-author">Yefan Zhi.</span>
    <span class="power-by">
        Powered by <a class="hexo-link" target="_blank" rel="noopener" href="https://hexo.io/">Hexo</a> and <a class="theme-link" target="_blank" rel="noopener" href="https://github.com/frostfan/hexo-theme-polarbear">Polar Bear</a>.
    </span>

    <!-- 不蒜子统计 -->
    
    <span class="footer-author">
        <script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
        <span id="busuanzi_container_site_pv"><span id="busuanzi_value_site_pv"></span> total views.</span>
    </span>
    
</span>


      </footer>

      <div class="back-to-top" id="back-to-top">
        <i class="iconfont icon-up"></i>
      </div>
    </div>
    

<script type="text/javascript">
  var disqus_shortname = 'andrew-zhi-stockpile';
  var disqus_identifier = '2021/06/08/Wi-Fi-and-Video-Data/';

  var disqus_title = "基于Wi-Fi和视频数据的农村空间行为时空特征研究";


  var disqus = {
    load : function disqus(){
        if(typeof DISQUS !== 'object') {
          (function () {
          var s = document.createElement('script'); s.async = true;
          s.type = 'text/javascript';
          s.src = '//' + disqus_shortname + '.disqus.com/embed.js';
          (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
          }());
          $('#load-disqus').remove(); ///加载后移除按钮
        }
    }
  }

  
    var disqus_config = function () {
        this.page.url = disqus_url;
        this.page.identifier = disqus_identifier;
        this.page.title = disqus_title;
    };
  

</script>


    




  
    <script type="text/javascript" src="/lib/jquery/jquery-3.1.1.min.js"></script>
  

  

    <script type="text/javascript" src="/js/src/theme.js?v=1.1"></script>
<script type="text/javascript" src="/js/src/bootstrap.js?v=1.1"></script>

  </body>
</html>
